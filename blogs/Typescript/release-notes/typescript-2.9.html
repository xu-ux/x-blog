<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TypeScript 2.9</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/x-blog/assets/css/0.styles.a8b387b1.css" as="style"><link rel="preload" href="/x-blog/assets/js/app.23c4f710.js" as="script"><link rel="preload" href="/x-blog/assets/js/2.da819b68.js" as="script"><link rel="preload" href="/x-blog/assets/js/111.74367cd9.js" as="script"><link rel="prefetch" href="/x-blog/assets/js/10.25793e01.js"><link rel="prefetch" href="/x-blog/assets/js/100.1977637a.js"><link rel="prefetch" href="/x-blog/assets/js/101.eba0db21.js"><link rel="prefetch" href="/x-blog/assets/js/102.e67ebdcf.js"><link rel="prefetch" href="/x-blog/assets/js/103.1d5e0af2.js"><link rel="prefetch" href="/x-blog/assets/js/104.3929f774.js"><link rel="prefetch" href="/x-blog/assets/js/105.e8e14507.js"><link rel="prefetch" href="/x-blog/assets/js/106.b6d1e284.js"><link rel="prefetch" href="/x-blog/assets/js/107.cdc19914.js"><link rel="prefetch" href="/x-blog/assets/js/108.ecb27e52.js"><link rel="prefetch" href="/x-blog/assets/js/109.81bf166a.js"><link rel="prefetch" href="/x-blog/assets/js/11.3b08d245.js"><link rel="prefetch" href="/x-blog/assets/js/110.75fa3eae.js"><link rel="prefetch" href="/x-blog/assets/js/112.ce0e319a.js"><link rel="prefetch" href="/x-blog/assets/js/113.3aa91524.js"><link rel="prefetch" href="/x-blog/assets/js/114.6bde0457.js"><link rel="prefetch" href="/x-blog/assets/js/115.18988e08.js"><link rel="prefetch" href="/x-blog/assets/js/116.1e92ff83.js"><link rel="prefetch" href="/x-blog/assets/js/117.0f3f5848.js"><link rel="prefetch" href="/x-blog/assets/js/118.f622a832.js"><link rel="prefetch" href="/x-blog/assets/js/119.0f320cac.js"><link rel="prefetch" href="/x-blog/assets/js/12.ddaa2f4a.js"><link rel="prefetch" href="/x-blog/assets/js/120.caa0737b.js"><link rel="prefetch" href="/x-blog/assets/js/121.023c8625.js"><link rel="prefetch" href="/x-blog/assets/js/122.b8c7be7f.js"><link rel="prefetch" href="/x-blog/assets/js/123.2634a2ab.js"><link rel="prefetch" href="/x-blog/assets/js/124.3edaaeb2.js"><link rel="prefetch" href="/x-blog/assets/js/125.eeae4a8f.js"><link rel="prefetch" href="/x-blog/assets/js/126.a2ecc03b.js"><link rel="prefetch" href="/x-blog/assets/js/127.69fdb098.js"><link rel="prefetch" href="/x-blog/assets/js/128.30cf5508.js"><link rel="prefetch" href="/x-blog/assets/js/129.a1afcf02.js"><link rel="prefetch" href="/x-blog/assets/js/13.7454307a.js"><link rel="prefetch" href="/x-blog/assets/js/130.668cc0f3.js"><link rel="prefetch" href="/x-blog/assets/js/131.b3b44ae4.js"><link rel="prefetch" href="/x-blog/assets/js/132.d047e961.js"><link rel="prefetch" href="/x-blog/assets/js/133.7dd84ff2.js"><link rel="prefetch" href="/x-blog/assets/js/134.90ef6c0d.js"><link rel="prefetch" href="/x-blog/assets/js/135.5ded71ee.js"><link rel="prefetch" href="/x-blog/assets/js/136.90b2a527.js"><link rel="prefetch" href="/x-blog/assets/js/137.10d39328.js"><link rel="prefetch" href="/x-blog/assets/js/138.7395e902.js"><link rel="prefetch" href="/x-blog/assets/js/139.36a7731d.js"><link rel="prefetch" href="/x-blog/assets/js/14.62759af3.js"><link rel="prefetch" href="/x-blog/assets/js/140.8514b6bc.js"><link rel="prefetch" href="/x-blog/assets/js/141.56778ca3.js"><link rel="prefetch" href="/x-blog/assets/js/142.00571244.js"><link rel="prefetch" href="/x-blog/assets/js/143.d3e00ad5.js"><link rel="prefetch" href="/x-blog/assets/js/144.9cf0f0ad.js"><link rel="prefetch" href="/x-blog/assets/js/15.875b9a65.js"><link rel="prefetch" href="/x-blog/assets/js/16.a0914b63.js"><link rel="prefetch" href="/x-blog/assets/js/17.f791c512.js"><link rel="prefetch" href="/x-blog/assets/js/18.ceba93c9.js"><link rel="prefetch" href="/x-blog/assets/js/19.bc95d553.js"><link rel="prefetch" href="/x-blog/assets/js/20.ad9e9143.js"><link rel="prefetch" href="/x-blog/assets/js/21.22708bcb.js"><link rel="prefetch" href="/x-blog/assets/js/22.8ec3fb69.js"><link rel="prefetch" href="/x-blog/assets/js/23.c5c865ea.js"><link rel="prefetch" href="/x-blog/assets/js/24.8f06c2bb.js"><link rel="prefetch" href="/x-blog/assets/js/25.503ee2fc.js"><link rel="prefetch" href="/x-blog/assets/js/26.1166aa8a.js"><link rel="prefetch" href="/x-blog/assets/js/27.216a4c52.js"><link rel="prefetch" href="/x-blog/assets/js/28.6530d3f0.js"><link rel="prefetch" href="/x-blog/assets/js/29.72e82756.js"><link rel="prefetch" href="/x-blog/assets/js/3.d8d3bc9a.js"><link rel="prefetch" href="/x-blog/assets/js/30.29107809.js"><link rel="prefetch" href="/x-blog/assets/js/31.0cc8b406.js"><link rel="prefetch" href="/x-blog/assets/js/32.13338c60.js"><link rel="prefetch" href="/x-blog/assets/js/33.ea8b3494.js"><link rel="prefetch" href="/x-blog/assets/js/34.e3d28742.js"><link rel="prefetch" href="/x-blog/assets/js/35.12b320e8.js"><link rel="prefetch" href="/x-blog/assets/js/36.b44bb5c7.js"><link rel="prefetch" href="/x-blog/assets/js/37.4fa27b9e.js"><link rel="prefetch" href="/x-blog/assets/js/38.59f8c99d.js"><link rel="prefetch" href="/x-blog/assets/js/39.02f5b200.js"><link rel="prefetch" href="/x-blog/assets/js/4.302e112e.js"><link rel="prefetch" href="/x-blog/assets/js/40.12e16efa.js"><link rel="prefetch" href="/x-blog/assets/js/41.e26b7b17.js"><link rel="prefetch" href="/x-blog/assets/js/42.ddc901dd.js"><link rel="prefetch" href="/x-blog/assets/js/43.4d1ab6af.js"><link rel="prefetch" href="/x-blog/assets/js/44.915cd1fe.js"><link rel="prefetch" href="/x-blog/assets/js/45.51f58749.js"><link rel="prefetch" href="/x-blog/assets/js/46.91e4591a.js"><link rel="prefetch" href="/x-blog/assets/js/47.8c88c25e.js"><link rel="prefetch" href="/x-blog/assets/js/48.27b8bd7d.js"><link rel="prefetch" href="/x-blog/assets/js/49.4bdc7847.js"><link rel="prefetch" href="/x-blog/assets/js/5.75c1c4c8.js"><link rel="prefetch" href="/x-blog/assets/js/50.bc55da43.js"><link rel="prefetch" href="/x-blog/assets/js/51.aef086ea.js"><link rel="prefetch" href="/x-blog/assets/js/52.023d8419.js"><link rel="prefetch" href="/x-blog/assets/js/53.440aa203.js"><link rel="prefetch" href="/x-blog/assets/js/54.61ecd16e.js"><link rel="prefetch" href="/x-blog/assets/js/55.d3adc26f.js"><link rel="prefetch" href="/x-blog/assets/js/56.3e3118af.js"><link rel="prefetch" href="/x-blog/assets/js/57.64af4f91.js"><link rel="prefetch" href="/x-blog/assets/js/58.d4c0e123.js"><link rel="prefetch" href="/x-blog/assets/js/59.1b2a30b4.js"><link rel="prefetch" href="/x-blog/assets/js/6.64d1cd93.js"><link rel="prefetch" href="/x-blog/assets/js/60.ab4cb31e.js"><link rel="prefetch" href="/x-blog/assets/js/61.c206cf37.js"><link rel="prefetch" href="/x-blog/assets/js/62.6c609148.js"><link rel="prefetch" href="/x-blog/assets/js/63.631814fa.js"><link rel="prefetch" href="/x-blog/assets/js/64.a8b34c2a.js"><link rel="prefetch" href="/x-blog/assets/js/65.54602cfa.js"><link rel="prefetch" href="/x-blog/assets/js/66.a4ebcfb4.js"><link rel="prefetch" href="/x-blog/assets/js/67.eae8e481.js"><link rel="prefetch" href="/x-blog/assets/js/68.f858140e.js"><link rel="prefetch" href="/x-blog/assets/js/69.bb2cc7b7.js"><link rel="prefetch" href="/x-blog/assets/js/7.0f61aaef.js"><link rel="prefetch" href="/x-blog/assets/js/70.29f053ec.js"><link rel="prefetch" href="/x-blog/assets/js/71.8fcf91da.js"><link rel="prefetch" href="/x-blog/assets/js/72.292391ff.js"><link rel="prefetch" href="/x-blog/assets/js/73.bc64b0e8.js"><link rel="prefetch" href="/x-blog/assets/js/74.89c122a8.js"><link rel="prefetch" href="/x-blog/assets/js/75.7c83f756.js"><link rel="prefetch" href="/x-blog/assets/js/76.143ab6fa.js"><link rel="prefetch" href="/x-blog/assets/js/77.78dc477e.js"><link rel="prefetch" href="/x-blog/assets/js/78.336f266d.js"><link rel="prefetch" href="/x-blog/assets/js/79.1b8a8174.js"><link rel="prefetch" href="/x-blog/assets/js/8.186418e2.js"><link rel="prefetch" href="/x-blog/assets/js/80.5c387c5a.js"><link rel="prefetch" href="/x-blog/assets/js/81.468d2443.js"><link rel="prefetch" href="/x-blog/assets/js/82.88851a9c.js"><link rel="prefetch" href="/x-blog/assets/js/83.a5b39e7f.js"><link rel="prefetch" href="/x-blog/assets/js/84.c551e325.js"><link rel="prefetch" href="/x-blog/assets/js/85.12422bf7.js"><link rel="prefetch" href="/x-blog/assets/js/86.bf66847b.js"><link rel="prefetch" href="/x-blog/assets/js/87.7864529e.js"><link rel="prefetch" href="/x-blog/assets/js/88.8ed2a1a3.js"><link rel="prefetch" href="/x-blog/assets/js/89.ca77c00c.js"><link rel="prefetch" href="/x-blog/assets/js/9.50ea345f.js"><link rel="prefetch" href="/x-blog/assets/js/90.864ebaaa.js"><link rel="prefetch" href="/x-blog/assets/js/91.210b8a85.js"><link rel="prefetch" href="/x-blog/assets/js/92.69ada891.js"><link rel="prefetch" href="/x-blog/assets/js/93.57e209ef.js"><link rel="prefetch" href="/x-blog/assets/js/94.b7b84a2c.js"><link rel="prefetch" href="/x-blog/assets/js/95.45e6b2b7.js"><link rel="prefetch" href="/x-blog/assets/js/96.90b784c8.js"><link rel="prefetch" href="/x-blog/assets/js/97.2026a43a.js"><link rel="prefetch" href="/x-blog/assets/js/98.14fa92ed.js"><link rel="prefetch" href="/x-blog/assets/js/99.bbc79558.js">
    <link rel="stylesheet" href="/x-blog/assets/css/0.styles.a8b387b1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/x-blog/" class="home-link router-link-active"><img src="/x-blog/img/logoS.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/x-blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/x-blog/guide/" class="nav-link">
  专栏
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><span class="title">教程</span> <span class="arrow down"></span></button> <button type="button" aria-label="教程" class="mobile-dropdown-title"><span class="title">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/GithubActions/" class="nav-link">
  GithubAction
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/VuePress/" class="nav-link">
  Vuepress
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><span class="title">书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="书籍" class="mobile-dropdown-title"><span class="title">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Typescript/" class="nav-link router-link-active">
  《Typescript》
</a></li></ul></div></div><div class="nav-item"><a href="https://xu-ux.github.io/note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/xu-ux/x-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    仓库
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/x-blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/x-blog/guide/" class="nav-link">
  专栏
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><span class="title">教程</span> <span class="arrow down"></span></button> <button type="button" aria-label="教程" class="mobile-dropdown-title"><span class="title">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/GithubActions/" class="nav-link">
  GithubAction
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/VuePress/" class="nav-link">
  Vuepress
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><span class="title">书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="书籍" class="mobile-dropdown-title"><span class="title">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Typescript/" class="nav-link router-link-active">
  《Typescript》
</a></li></ul></div></div><div class="nav-item"><a href="https://xu-ux.github.io/note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/xu-ux/x-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    仓库
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Release Notes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.8.html" class="sidebar-link">TypeScript 2.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/" aria-current="page" class="sidebar-link">新增功能</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.3.html" class="sidebar-link">TypeScript 1.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.4.html" class="sidebar-link">TypeScript 1.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.5.html" class="sidebar-link">TypeScript 1.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html" class="sidebar-link">TypeScript 1.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.7.html" class="sidebar-link">TypeScript 1.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.8.html" class="sidebar-link">TypeScript 1.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html" class="sidebar-link">TypeScript 2.0</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.1.html" class="sidebar-link">TypeScript 2.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.2.html" class="sidebar-link">TypeScript 2.2</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.3.html" class="sidebar-link">TypeScript 2.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.4.html" class="sidebar-link">TypeScript 2.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.5.html" class="sidebar-link">TypeScript 2.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.6.html" class="sidebar-link">TypeScript 2.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.7.html" class="sidebar-link">TypeScript 2.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.1.html" class="sidebar-link">TypeScript 1.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html" aria-current="page" class="active sidebar-link">TypeScript 2.9</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#keyof和映射类型支持用number和symbol命名的属性" class="sidebar-link">keyof和映射类型支持用number和symbol命名的属性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#例子" class="sidebar-link">例子</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#例子-2" class="sidebar-link">例子</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#推荐" class="sidebar-link">推荐</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#jsx元素里的泛型参数" class="sidebar-link">JSX元素里的泛型参数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#例子-3" class="sidebar-link">例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#泛型标记模版里的泛型参数" class="sidebar-link">泛型标记模版里的泛型参数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#例子-4" class="sidebar-link">例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#import类型" class="sidebar-link">import类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#例子-5" class="sidebar-link">例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#放开声明生成时可见性规则" class="sidebar-link">放开声明生成时可见性规则</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#支持import-meta" class="sidebar-link">支持import.meta</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#例子-6" class="sidebar-link">例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#新的-resolvejsonmodule" class="sidebar-link">新的--resolveJsonModule</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#例子-7" class="sidebar-link">例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#默认-pretty输出" class="sidebar-link">默认--pretty输出</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html#新的-declarationmap" class="sidebar-link">新的--declarationMap</a></li></ul></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.0.html" class="sidebar-link">TypeScript 3.0</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.1.html" class="sidebar-link">TypeScript 3.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.2.html" class="sidebar-link">TypeScript 3.2</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.3.html" class="sidebar-link">TypeScript 3.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.4.html" class="sidebar-link">TypeScript 3.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.5.html" class="sidebar-link">TypeScript 3.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.6.html" class="sidebar-link">TypeScript 3.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.7.html" class="sidebar-link">TypeScript 3.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.8.html" class="sidebar-link">TypeScript 3.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.9.html" class="sidebar-link">改进类型推断和Promise.all</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.0.html" class="sidebar-link">可变参元组类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.1.html" class="sidebar-link">模版字面量类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.2.html" class="sidebar-link">更智能地保留类型别名</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.3.html" class="sidebar-link">拆分属性的写入类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html" class="sidebar-link">针对条件表达式和判别式的别名引用进行控制流分析</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="typescript-2-9"><a href="#typescript-2-9" class="header-anchor">#</a> TypeScript 2.9</h1> <h2 id="keyof和映射类型支持用number和symbol命名的属性"><a href="#keyof和映射类型支持用number和symbol命名的属性" class="header-anchor">#</a> <code>keyof</code>和映射类型支持用<code>number</code>和<code>symbol</code>命名的属性</h2> <p>TypeScript 2.9增加了在索引类型和映射类型上支持用<code>number</code>和<code>symbol</code>命名属性。 在之前，<code>keyof</code>操作符和映射类型只支持<code>string</code>命名的属性。</p> <p>改动包括：</p> <ul><li>对某些类型<code>T</code>，索引类型<code>keyof T</code>是<code>string | number | symbol</code>的子类型。</li> <li>映射类型<code>{ [P in K]: XXX }</code>，其中<code>K</code>允许是可以赋值给<code>string | number | symbol</code>的任何值。</li> <li>针对泛型<code>T</code>的对象的<code>for...in</code>语句，迭代变量推断类型之前为<code>keyof T</code>，现在是<code>Extract&lt;keyof T, string&gt;</code>。（换句话说，是<code>keyof T</code>的子集，它仅包含类字符串的值。）</li></ul> <p>对于对象类型<code>X</code>，<code>keyof X</code>将按以下方式解析：</p> <ul><li>如果<code>X</code>带有字符串索引签名，则<code>keyof X</code>为<code>string</code>，<code>number</code>和表示symbol-like属性的字面量类型的联合，否则</li> <li>如果<code>X</code>带有数字索引签名，则<code>keyof X</code>为<code>number</code>和表示string-like和symbol-like属性的字面量类型的联合，否则</li> <li><code>keyof X</code>为表示string-like，number-like和symbol-like属性的字面量类型的联合。</li></ul> <p>在何处：</p> <ul><li>对象类型的string-like属性，是那些使用标识符，字符串字面量或计算后值为字符串字面量类型的属性名所声明的。</li> <li>对象类型的number-like属性是那些使用数字字面量或计算后值为数字字面量类型的属性名所声明的。</li> <li>对象类型的symbol-like属性是那些使用计算后值为symbol字面量类型的属性名所声明的。</li></ul> <p>对于映射类型<code>{ [P in K]: XXX }</code>，<code>K</code>的每个字符串字面量类型都会引入一个名字为字符串的属性，<code>K</code>的每个数字字面量类型都会引入一个名字为数字的属性，<code>K</code>的每个symbol字面量类型都会引入一个名字为symbol的属性。 并且，如果<code>K</code>包含<code>string</code>类型，那个同时也会引入字符串索引类型，如果<code>K</code>包含<code>number</code>类型，那个同时也会引入数字索引类型。</p> <h3 id="例子"><a href="#例子" class="header-anchor">#</a> 例子</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> d <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> e <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">enum</span> <span class="token constant">E1</span> <span class="token punctuation">{</span> <span class="token constant">A</span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token punctuation">,</span> <span class="token constant">C</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token keyword">enum</span> <span class="token constant">E2</span> <span class="token punctuation">{</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token constant">B</span> <span class="token operator">=</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token string">&quot;C&quot;</span> <span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Foo</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>       <span class="token comment">// String-like name</span>
    <span class="token number">5</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>       <span class="token comment">// Number-like name</span>
    <span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>     <span class="token comment">// String-like name</span>
    <span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>     <span class="token comment">// Number-like name</span>
    <span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>     <span class="token comment">// Symbol-like name</span>
    <span class="token punctuation">[</span><span class="token constant">E1</span><span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>  <span class="token comment">// Number-like name</span>
    <span class="token punctuation">[</span><span class="token constant">E2</span><span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>  <span class="token comment">// String-like name</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">K1</span></span> <span class="token operator">=</span> <span class="token keyword">keyof</span> Foo<span class="token punctuation">;</span>  <span class="token comment">// &quot;a&quot; | 5 | &quot;c&quot; | 10 | typeof e | E1.A | E2.A</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">K2</span></span> <span class="token operator">=</span> Extract<span class="token operator">&lt;</span><span class="token keyword">keyof</span> Foo<span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;a&quot; | &quot;c&quot; | E2.A</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">K3</span></span> <span class="token operator">=</span> Extract<span class="token operator">&lt;</span><span class="token keyword">keyof</span> Foo<span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// 5 | 10 | E1.A</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">K4</span></span> <span class="token operator">=</span> Extract<span class="token operator">&lt;</span><span class="token keyword">keyof</span> Foo<span class="token punctuation">,</span> <span class="token builtin">symbol</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// typeof e</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>现在通过在键值类型里包含<code>number</code>类型，<code>keyof</code>就能反映出数字索引签名的存在，因此像<code>Partial&lt;T&gt;</code>和<code>Readonly&lt;T&gt;</code>的映射类型能够正确地处理带数字索引签名的对象类型：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Arrayish<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">ReadonlyArrayish<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> Readonly<span class="token operator">&lt;</span>Arrayish<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">const</span> map<span class="token operator">:</span> ReadonlyArrayish<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> n <span class="token operator">=</span> map<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> map<span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// Previously of type any (or an error with --noImplicitAny)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>此外，由于<code>keyof</code>支持用<code>number</code>和<code>symbol</code>命名的键值，现在可以对对象的数字字面量（如数字枚举类型）和唯一的symbol属性的访问进行抽象。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token keyword">enum</span> Enum <span class="token punctuation">{</span> <span class="token constant">A</span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token punctuation">,</span> <span class="token constant">C</span> <span class="token punctuation">}</span>

<span class="token keyword">const</span> enumToStringMap <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>Enum<span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">&quot;Name A&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>Enum<span class="token punctuation">.</span><span class="token constant">B</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">&quot;Name B&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>Enum<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">&quot;Name C&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> sym1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sym2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sym3 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> symbolToNumberMap <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>sym1<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>sym2<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>sym3<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">KE</span></span> <span class="token operator">=</span> <span class="token keyword">keyof</span> <span class="token keyword">typeof</span> enumToStringMap<span class="token punctuation">;</span>     <span class="token comment">// Enum (i.e. Enum.A | Enum.B | Enum.C)</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">KS</span></span> <span class="token operator">=</span> <span class="token keyword">keyof</span> <span class="token keyword">typeof</span> symbolToNumberMap<span class="token punctuation">;</span>   <span class="token comment">// typeof sym1 | typeof sym2 | typeof sym3</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getValue</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> x1 <span class="token operator">=</span> <span class="token function">getValue</span><span class="token punctuation">(</span>enumToStringMap<span class="token punctuation">,</span> Enum<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Returns &quot;Name C&quot;</span>
<span class="token keyword">let</span> x2 <span class="token operator">=</span> <span class="token function">getValue</span><span class="token punctuation">(</span>symbolToNumberMap<span class="token punctuation">,</span> sym3<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Returns 3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>这是一个破坏性改动；之前，<code>keyof</code>操作符和映射类型只支持<code>string</code>命名的属性。 那些把总是把<code>keyof T</code>的类型当做<code>string</code>的代码现在会报错。</p> <h3 id="例子-2"><a href="#例子-2" class="header-anchor">#</a> 例子</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">useKey</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>o<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> k<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> k<span class="token punctuation">;</span>  <span class="token comment">// 错误：keyof T不能赋值给字符串</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="推荐"><a href="#推荐" class="header-anchor">#</a> 推荐</h3> <ul><li><p>如果函数只能处理字符串命名属性的键，在声明里使用<code>Extract&lt;keyof T, string&gt;</code>：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">useKey</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> Extract<span class="token operator">&lt;</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span>o<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> k<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> k<span class="token punctuation">;</span>  <span class="token comment">// OK</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>如果函数能处理任何属性的键，那么可以在下游进行改动：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">useKey</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>o<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> k<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">symbol</span> <span class="token operator">=</span> k<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>否则，使用<code>--keyofStringsOnly</code>编译器选项来禁用新的行为。</p></li></ul> <h2 id="jsx元素里的泛型参数"><a href="#jsx元素里的泛型参数" class="header-anchor">#</a> JSX元素里的泛型参数</h2> <p>JSX元素现在允许传入类型参数到泛型组件里。</p> <h3 id="例子-3"><a href="#例子-3" class="header-anchor">#</a> 例子</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GenericComponent<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    internalProp<span class="token operator">:</span> <span class="token constant">P</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Props</span> <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> b<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token operator">&lt;</span>GenericComponent<span class="token operator">&lt;</span>Props<span class="token operator">&gt;</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">}</span> b<span class="token operator">=</span><span class="token string">&quot;hi&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>

<span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token operator">&lt;</span>GenericComponent<span class="token operator">&lt;</span>Props<span class="token operator">&gt;</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">}</span> b<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">20</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="泛型标记模版里的泛型参数"><a href="#泛型标记模版里的泛型参数" class="header-anchor">#</a> 泛型标记模版里的泛型参数</h2> <p>标记模版是ECMAScript 2015引入的一种调用形式。 类似调用表达式，可以在标记模版里使用泛型函数，TypeScript会推断使用的类型参数。</p> <p>TypeScript 2.9允许传入泛型参数到标记模版字符串。</p> <h3 id="例子-4"><a href="#例子-4" class="header-anchor">#</a> 例子</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">styledComponent</span><span class="token generic class-name"><span class="token operator">&lt;</span>Props<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>strs<span class="token operator">:</span> TemplateStringsArray<span class="token punctuation">)</span><span class="token operator">:</span> Component<span class="token operator">&lt;</span>Props<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">MyProps</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

styledComponent<span class="token operator">&lt;</span>MyProps<span class="token operator">&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  font-size: 1.5em;
  text-align: center;
  color: palevioletred;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">tag</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>strs<span class="token operator">:</span> TemplateStringsArray<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// inference fails because 'number' and 'string' are both candidates that conflict</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> tag<span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">100</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token string">&quot;hello&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="import类型"><a href="#import类型" class="header-anchor">#</a> <code>import</code>类型</h2> <p>模块可以导入在其它模块里声明的类型。但是非模块的全局脚本不能访问模块里声明的类型。这里，<code>import</code>类型登场了。</p> <p>在类型注释的位置使用<code>import(&quot;mod&quot;)</code>，就可以访问一个模块和它导出的声明，而不必导入它。</p> <h3 id="例子-5"><a href="#例子-5" class="header-anchor">#</a> 例子</h3> <p>在一个模块文件里，有一个<code>Pet</code>类的声明：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// module.d.ts</span>

<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">class</span> <span class="token class-name">Pet</span> <span class="token punctuation">{</span>
   name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>它可以被用在非模块文件<code>global-script.ts</code>：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// global-script.ts</span>

<span class="token keyword">function</span> <span class="token function">adopt</span><span class="token punctuation">(</span>p<span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./module&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Pet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Adopting </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>p<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>它也可以被放在<code>.js</code>文件的JSDoc注释里，来引用模块里的类型：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// a.js</span>

<span class="token comment">/**
 * @param p { import(&quot;./module&quot;).Pet }
 */</span>
<span class="token keyword">function</span> <span class="token function">walk</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Walking </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>p<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="放开声明生成时可见性规则"><a href="#放开声明生成时可见性规则" class="header-anchor">#</a> 放开声明生成时可见性规则</h2> <p>随着<code>import</code>类型的到来，许多在声明文件生成阶段报的可见性错误可以被编译器正确地处理，而不需要改变输入。</p> <p>例如：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createHash <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;crypto&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> hash <span class="token operator">=</span> <span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">&quot;sha256&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//           ^^^^</span>
<span class="token comment">// Exported variable 'hash' has or is using name 'Hash' from external module &quot;crypto&quot; but cannot be named.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>TypeScript 2.9不会报错，生成文件如下：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> hash<span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;crypto&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Hash<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="支持import-meta"><a href="#支持import-meta" class="header-anchor">#</a> 支持<code>import.meta</code></h2> <p>TypeScript 2.9引入对<code>import.meta</code>的支持，它是当前<a href="https://github.com/tc39/proposal-import-meta" target="_blank" rel="noopener noreferrer">TC39建议<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>里的一个元属性。</p> <p><code>import.meta</code>类型是全局的<code>ImportMeta</code>类型，它在<code>lib.es5.d.ts</code>里定义。 这个接口地使用十分有限。 添加众所周知的Node和浏览器属性需要进行接口合并，还有可能需要根据上下文来增加全局空间。</p> <h3 id="例子-6"><a href="#例子-6" class="header-anchor">#</a> 例子</h3> <p>假设<code>__dirname</code>永远存在于<code>import.meta</code>，那么可以通过重新开放<code>ImportMeta</code>接口来进行声明：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// node.d.ts</span>
<span class="token keyword">interface</span> <span class="token class-name">ImportMeta</span> <span class="token punctuation">{</span>
    __dirname<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>用法如下：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>__dirname <span class="token comment">// Has type 'string'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>import.meta</code>仅在输出目标为<code>ESNext</code>模块和ECMAScript时才生效。</p> <h2 id="新的-resolvejsonmodule"><a href="#新的-resolvejsonmodule" class="header-anchor">#</a> 新的<code>--resolveJsonModule</code></h2> <p>在Node.js应用里经常需要使用<code>.json</code>。TypeScript 2.9的<code>--resolveJsonModule</code>允许从<code>.json</code>文件里导入，获取类型。</p> <h3 id="例子-7"><a href="#例子-7" class="header-anchor">#</a> 例子</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// settings.json</span>

<span class="token punctuation">{</span>
    <span class="token string">&quot;repo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TypeScript&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;dry&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string">&quot;debug&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// a.ts</span>

<span class="token keyword">import</span> settings <span class="token keyword">from</span> <span class="token string">&quot;./settings.json&quot;</span><span class="token punctuation">;</span>

settings<span class="token punctuation">.</span>debug <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">// OK</span>
settings<span class="token punctuation">.</span>dry <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment">// Error: Operator '===' cannot be applied boolean and number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// tsconfig.json</span>

<span class="token punctuation">{</span>
    <span class="token string">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolveJsonModule&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">&quot;esModuleInterop&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="默认-pretty输出"><a href="#默认-pretty输出" class="header-anchor">#</a> 默认<code>--pretty</code>输出</h2> <p>从TypeScript 2.9开始，如果应用支持彩色文字，那么错误输出时会默认应用<code>--pretty</code>。 TypeScript会检查输出流是否设置了<a href="https://nodejs.org/api/tty.html" target="_blank" rel="noopener noreferrer"><code>isTty</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>属性。</p> <p>使用<code>--pretty false</code>命令行选项或<code>tsconfig.json</code>里设置<code>&quot;pretty&quot;: false</code>来禁用<code>--pretty</code>输出。</p> <h2 id="新的-declarationmap"><a href="#新的-declarationmap" class="header-anchor">#</a> 新的<code>--declarationMap</code></h2> <p>随着<code>--declaration</code>一起启用<code>--declarationMap</code>，编译器在生成<code>.d.ts</code>的同时还会生成<code>.d.ts.map</code>。 语言服务现在也能够理解这些map文件，将声明文件映射到源码。</p> <p>换句话说，在启用了<code>--declarationMap</code>后生成的<code>.d.ts</code>文件里点击go-to-definition，将会导航到源文件里的位置（<code>.ts</code>），而不是导航到<code>.d.ts</code>文件里。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/xu-ux/x-blog/edit/master/docs/blogs/Typescript/release-notes/typescript-2.9.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">9/7/2021, 14:33:12</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/x-blog/blogs/Typescript/release-notes/typescript-1.1.html" class="prev">
        TypeScript 1.1
      </a></span> <span class="next"><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.0.html">
        TypeScript 3.0
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/x-blog/assets/js/app.23c4f710.js" defer></script><script src="/x-blog/assets/js/2.da819b68.js" defer></script><script src="/x-blog/assets/js/111.74367cd9.js" defer></script>
  </body>
</html>
