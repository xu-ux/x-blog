<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TypeScript 2.0</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/x-blog/assets/css/0.styles.af21f303.css" as="style"><link rel="preload" href="/x-blog/assets/js/app.ec786a75.js" as="script"><link rel="preload" href="/x-blog/assets/js/19.fd1c5163.js" as="script"><link rel="preload" href="/x-blog/assets/js/1.d44acf8c.js" as="script"><link rel="preload" href="/x-blog/assets/js/2.c1e8940e.js" as="script"><link rel="preload" href="/x-blog/assets/js/108.014ca44d.js" as="script"><link rel="prefetch" href="/x-blog/assets/js/10.0822dd21.js"><link rel="prefetch" href="/x-blog/assets/js/100.5b53ee8b.js"><link rel="prefetch" href="/x-blog/assets/js/101.6e432131.js"><link rel="prefetch" href="/x-blog/assets/js/102.db40c784.js"><link rel="prefetch" href="/x-blog/assets/js/103.ac69336f.js"><link rel="prefetch" href="/x-blog/assets/js/104.1b6bdb96.js"><link rel="prefetch" href="/x-blog/assets/js/105.54bb5017.js"><link rel="prefetch" href="/x-blog/assets/js/106.d6aba3f3.js"><link rel="prefetch" href="/x-blog/assets/js/107.97dab0c5.js"><link rel="prefetch" href="/x-blog/assets/js/109.441c070d.js"><link rel="prefetch" href="/x-blog/assets/js/11.74753923.js"><link rel="prefetch" href="/x-blog/assets/js/110.06545e85.js"><link rel="prefetch" href="/x-blog/assets/js/111.cf050824.js"><link rel="prefetch" href="/x-blog/assets/js/112.ca221708.js"><link rel="prefetch" href="/x-blog/assets/js/113.a5691732.js"><link rel="prefetch" href="/x-blog/assets/js/114.d6a706ed.js"><link rel="prefetch" href="/x-blog/assets/js/115.b50ed470.js"><link rel="prefetch" href="/x-blog/assets/js/116.c7836091.js"><link rel="prefetch" href="/x-blog/assets/js/117.f1510643.js"><link rel="prefetch" href="/x-blog/assets/js/118.73455c6e.js"><link rel="prefetch" href="/x-blog/assets/js/119.74beb724.js"><link rel="prefetch" href="/x-blog/assets/js/12.8d7153f5.js"><link rel="prefetch" href="/x-blog/assets/js/120.e57631c3.js"><link rel="prefetch" href="/x-blog/assets/js/121.6520150a.js"><link rel="prefetch" href="/x-blog/assets/js/122.4d052d48.js"><link rel="prefetch" href="/x-blog/assets/js/123.893c8d41.js"><link rel="prefetch" href="/x-blog/assets/js/124.fe66391c.js"><link rel="prefetch" href="/x-blog/assets/js/125.75fcd0cb.js"><link rel="prefetch" href="/x-blog/assets/js/126.eec9aa05.js"><link rel="prefetch" href="/x-blog/assets/js/127.6a3afb1b.js"><link rel="prefetch" href="/x-blog/assets/js/128.4cf6e949.js"><link rel="prefetch" href="/x-blog/assets/js/129.9bc02742.js"><link rel="prefetch" href="/x-blog/assets/js/13.4b814334.js"><link rel="prefetch" href="/x-blog/assets/js/130.82b8d9c6.js"><link rel="prefetch" href="/x-blog/assets/js/131.894a9d2a.js"><link rel="prefetch" href="/x-blog/assets/js/132.66fa5979.js"><link rel="prefetch" href="/x-blog/assets/js/133.020ad712.js"><link rel="prefetch" href="/x-blog/assets/js/134.0512cbd0.js"><link rel="prefetch" href="/x-blog/assets/js/135.cc3c6f8d.js"><link rel="prefetch" href="/x-blog/assets/js/136.3fb3987d.js"><link rel="prefetch" href="/x-blog/assets/js/137.beb02df1.js"><link rel="prefetch" href="/x-blog/assets/js/138.7d1a9567.js"><link rel="prefetch" href="/x-blog/assets/js/139.851a671c.js"><link rel="prefetch" href="/x-blog/assets/js/14.1227ecb5.js"><link rel="prefetch" href="/x-blog/assets/js/140.45b5f831.js"><link rel="prefetch" href="/x-blog/assets/js/141.96deea23.js"><link rel="prefetch" href="/x-blog/assets/js/142.d6b5fe14.js"><link rel="prefetch" href="/x-blog/assets/js/143.980168c3.js"><link rel="prefetch" href="/x-blog/assets/js/144.db1d6f2f.js"><link rel="prefetch" href="/x-blog/assets/js/145.4ccd61c6.js"><link rel="prefetch" href="/x-blog/assets/js/146.2054a16b.js"><link rel="prefetch" href="/x-blog/assets/js/147.14dfc258.js"><link rel="prefetch" href="/x-blog/assets/js/148.d1d1d4f6.js"><link rel="prefetch" href="/x-blog/assets/js/149.3f316ce5.js"><link rel="prefetch" href="/x-blog/assets/js/15.f04ed383.js"><link rel="prefetch" href="/x-blog/assets/js/150.13d25385.js"><link rel="prefetch" href="/x-blog/assets/js/16.7b638e0b.js"><link rel="prefetch" href="/x-blog/assets/js/17.294751ad.js"><link rel="prefetch" href="/x-blog/assets/js/18.f71b3409.js"><link rel="prefetch" href="/x-blog/assets/js/20.959facf9.js"><link rel="prefetch" href="/x-blog/assets/js/21.3f1a564f.js"><link rel="prefetch" href="/x-blog/assets/js/22.9cadf035.js"><link rel="prefetch" href="/x-blog/assets/js/23.8f0fdba6.js"><link rel="prefetch" href="/x-blog/assets/js/24.deb12f90.js"><link rel="prefetch" href="/x-blog/assets/js/25.a9ed162d.js"><link rel="prefetch" href="/x-blog/assets/js/26.930767d0.js"><link rel="prefetch" href="/x-blog/assets/js/27.cab70cbe.js"><link rel="prefetch" href="/x-blog/assets/js/28.66157b3b.js"><link rel="prefetch" href="/x-blog/assets/js/29.d7dff74a.js"><link rel="prefetch" href="/x-blog/assets/js/30.931a72ef.js"><link rel="prefetch" href="/x-blog/assets/js/31.f1b4074c.js"><link rel="prefetch" href="/x-blog/assets/js/32.8658bbc5.js"><link rel="prefetch" href="/x-blog/assets/js/33.879f5c3f.js"><link rel="prefetch" href="/x-blog/assets/js/34.242622d8.js"><link rel="prefetch" href="/x-blog/assets/js/35.dd613e7e.js"><link rel="prefetch" href="/x-blog/assets/js/36.0687e131.js"><link rel="prefetch" href="/x-blog/assets/js/37.ecd03c40.js"><link rel="prefetch" href="/x-blog/assets/js/38.d2adfc8f.js"><link rel="prefetch" href="/x-blog/assets/js/39.952ceeb1.js"><link rel="prefetch" href="/x-blog/assets/js/4.0bd0db3c.js"><link rel="prefetch" href="/x-blog/assets/js/40.6f2ba2f1.js"><link rel="prefetch" href="/x-blog/assets/js/41.c010783f.js"><link rel="prefetch" href="/x-blog/assets/js/42.6709bd93.js"><link rel="prefetch" href="/x-blog/assets/js/43.b922dd87.js"><link rel="prefetch" href="/x-blog/assets/js/44.37a96399.js"><link rel="prefetch" href="/x-blog/assets/js/45.1f85c897.js"><link rel="prefetch" href="/x-blog/assets/js/46.ac964771.js"><link rel="prefetch" href="/x-blog/assets/js/47.efba2421.js"><link rel="prefetch" href="/x-blog/assets/js/48.27615032.js"><link rel="prefetch" href="/x-blog/assets/js/49.d2fccbe7.js"><link rel="prefetch" href="/x-blog/assets/js/5.04788c13.js"><link rel="prefetch" href="/x-blog/assets/js/50.ebd5c36b.js"><link rel="prefetch" href="/x-blog/assets/js/51.c600a722.js"><link rel="prefetch" href="/x-blog/assets/js/52.00be2ae9.js"><link rel="prefetch" href="/x-blog/assets/js/53.0110d45b.js"><link rel="prefetch" href="/x-blog/assets/js/54.c2ff71a1.js"><link rel="prefetch" href="/x-blog/assets/js/55.b9ebbe5c.js"><link rel="prefetch" href="/x-blog/assets/js/56.018b04db.js"><link rel="prefetch" href="/x-blog/assets/js/57.738fec6c.js"><link rel="prefetch" href="/x-blog/assets/js/58.098150cb.js"><link rel="prefetch" href="/x-blog/assets/js/59.1172e6f0.js"><link rel="prefetch" href="/x-blog/assets/js/6.29ff4292.js"><link rel="prefetch" href="/x-blog/assets/js/60.d4659828.js"><link rel="prefetch" href="/x-blog/assets/js/61.d4f4672b.js"><link rel="prefetch" href="/x-blog/assets/js/62.2a66d503.js"><link rel="prefetch" href="/x-blog/assets/js/63.6564b213.js"><link rel="prefetch" href="/x-blog/assets/js/64.c4f8275b.js"><link rel="prefetch" href="/x-blog/assets/js/65.461392d9.js"><link rel="prefetch" href="/x-blog/assets/js/66.6a56e2e2.js"><link rel="prefetch" href="/x-blog/assets/js/67.7d795035.js"><link rel="prefetch" href="/x-blog/assets/js/68.66333e23.js"><link rel="prefetch" href="/x-blog/assets/js/69.246ea4ba.js"><link rel="prefetch" href="/x-blog/assets/js/7.df56f4aa.js"><link rel="prefetch" href="/x-blog/assets/js/70.b90ffb0e.js"><link rel="prefetch" href="/x-blog/assets/js/71.9d5e280c.js"><link rel="prefetch" href="/x-blog/assets/js/72.f9daadfc.js"><link rel="prefetch" href="/x-blog/assets/js/73.6372ef72.js"><link rel="prefetch" href="/x-blog/assets/js/74.92c0f9ab.js"><link rel="prefetch" href="/x-blog/assets/js/75.5c1cee69.js"><link rel="prefetch" href="/x-blog/assets/js/76.96f4091e.js"><link rel="prefetch" href="/x-blog/assets/js/77.5c61185a.js"><link rel="prefetch" href="/x-blog/assets/js/78.3d0582e9.js"><link rel="prefetch" href="/x-blog/assets/js/79.e1726c3b.js"><link rel="prefetch" href="/x-blog/assets/js/8.00d7100b.js"><link rel="prefetch" href="/x-blog/assets/js/80.13fb02f1.js"><link rel="prefetch" href="/x-blog/assets/js/81.080d37e3.js"><link rel="prefetch" href="/x-blog/assets/js/82.244d23eb.js"><link rel="prefetch" href="/x-blog/assets/js/83.baab1b70.js"><link rel="prefetch" href="/x-blog/assets/js/84.10b38c90.js"><link rel="prefetch" href="/x-blog/assets/js/85.2ff21a25.js"><link rel="prefetch" href="/x-blog/assets/js/86.4e841a70.js"><link rel="prefetch" href="/x-blog/assets/js/87.8d424ecf.js"><link rel="prefetch" href="/x-blog/assets/js/88.3f470344.js"><link rel="prefetch" href="/x-blog/assets/js/89.d3d009d5.js"><link rel="prefetch" href="/x-blog/assets/js/9.b86ac89d.js"><link rel="prefetch" href="/x-blog/assets/js/90.965c385b.js"><link rel="prefetch" href="/x-blog/assets/js/91.9d9ecb9f.js"><link rel="prefetch" href="/x-blog/assets/js/92.ee64f754.js"><link rel="prefetch" href="/x-blog/assets/js/93.6ae9dfde.js"><link rel="prefetch" href="/x-blog/assets/js/94.5806dff1.js"><link rel="prefetch" href="/x-blog/assets/js/95.f878e9c5.js"><link rel="prefetch" href="/x-blog/assets/js/96.7ea69021.js"><link rel="prefetch" href="/x-blog/assets/js/97.374b3951.js"><link rel="prefetch" href="/x-blog/assets/js/98.d0b400a1.js"><link rel="prefetch" href="/x-blog/assets/js/99.16554185.js">
    <link rel="stylesheet" href="/x-blog/assets/css/0.styles.af21f303.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/x-blog/" class="home-link router-link-active"><img src="/x-blog/img/logoS.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/x-blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/x-blog/guide/" class="nav-link">
  专栏
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><span class="title">教程</span> <span class="arrow down"></span></button> <button type="button" aria-label="教程" class="mobile-dropdown-title"><span class="title">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/GithubActions/" class="nav-link">
  GithubAction
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/VuePress/" class="nav-link">
  Vuepress
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><span class="title">书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="书籍" class="mobile-dropdown-title"><span class="title">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Typescript/" class="nav-link router-link-active">
  《Typescript》
</a></li></ul></div></div><div class="nav-item"><a href="https://xu-ux.github.io/note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/xu-ux/x-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    仓库
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/x-blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/x-blog/guide/" class="nav-link">
  专栏
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><span class="title">教程</span> <span class="arrow down"></span></button> <button type="button" aria-label="教程" class="mobile-dropdown-title"><span class="title">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/GithubActions/" class="nav-link">
  GithubAction
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/VuePress/" class="nav-link">
  Vuepress
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><span class="title">书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="书籍" class="mobile-dropdown-title"><span class="title">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Typescript/" class="nav-link router-link-active">
  《Typescript》
</a></li></ul></div></div><div class="nav-item"><a href="https://xu-ux.github.io/note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/xu-ux/x-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    仓库
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Release Notes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.8.html" class="sidebar-link">TypeScript 2.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/" aria-current="page" class="sidebar-link">新增功能</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.3.html" class="sidebar-link">TypeScript 1.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.4.html" class="sidebar-link">TypeScript 1.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.5.html" class="sidebar-link">TypeScript 1.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html" class="sidebar-link">TypeScript 1.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.7.html" class="sidebar-link">TypeScript 1.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.8.html" class="sidebar-link">TypeScript 1.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html" aria-current="page" class="active sidebar-link">TypeScript 2.0</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#null和undefined类型" class="sidebar-link">Null和undefined类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#strictnullchecks" class="sidebar-link">--strictNullChecks</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#使用前赋值检查" class="sidebar-link">使用前赋值检查</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#可选参数和属性" class="sidebar-link">可选参数和属性</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#非null和非undefined类型保护" class="sidebar-link">非null和非undefined类型保护</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#类型保护中的点名称" class="sidebar-link">类型保护中的点名称</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#表达式操作符" class="sidebar-link">表达式操作符</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#类型扩展" class="sidebar-link">类型扩展</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#非空断言操作符" class="sidebar-link">非空断言操作符</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#兼容性" class="sidebar-link">兼容性</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#基于控制流的类型分析" class="sidebar-link">基于控制流的类型分析</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#标记联合类型" class="sidebar-link">标记联合类型</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#never类型" class="sidebar-link">never类型</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#只读属性和索引签名" class="sidebar-link">只读属性和索引签名</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#指定函数中this类型" class="sidebar-link">指定函数中this类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#回调函数中的this参数" class="sidebar-link">回调函数中的this参数</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#noimplicitthis" class="sidebar-link">--noImplicitThis</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#tsconfig-json支持文件通配符" class="sidebar-link">tsconfig.json支持文件通配符</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#模块解析增加-baseurl、路径映射、rootdirs和追踪" class="sidebar-link">模块解析增加：BaseUrl、路径映射、rootDirs和追踪</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#base-url" class="sidebar-link">Base URL</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#路径映射" class="sidebar-link">路径映射</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#rootdirs和虚拟目录" class="sidebar-link">rootDirs和虚拟目录</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#追踪模块解析" class="sidebar-link">追踪模块解析</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#快捷外部模块声明" class="sidebar-link">快捷外部模块声明</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#模块名称中的通配符" class="sidebar-link">模块名称中的通配符</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#支持umd模块定义" class="sidebar-link">支持UMD模块定义</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#可选类属性" class="sidebar-link">可选类属性</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#私有的和受保护的构造函数" class="sidebar-link">私有的和受保护的构造函数</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#抽象属性和访问器" class="sidebar-link">抽象属性和访问器</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#隐式索引签名" class="sidebar-link">隐式索引签名</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#使用-lib编译参数包含内置类型声明" class="sidebar-link">使用--lib编译参数包含内置类型声明</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#使用-nounusedparameters和-nounusedlocals标记未使用的声明" class="sidebar-link">使用--noUnusedParameters和--noUnusedLocals标记未使用的声明</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#模块名称允许-js扩展名" class="sidebar-link">模块名称允许.js扩展名</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#支持编译参数target-es5和module-es6同时使用" class="sidebar-link">支持编译参数target : es5和module: es6同时使用</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#函数形参和实参列表末尾支持逗号" class="sidebar-link">函数形参和实参列表末尾支持逗号</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#新编译参数-skiplibcheck" class="sidebar-link">新编译参数--skipLibCheck</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#允许在声明中重复标识符" class="sidebar-link">允许在声明中重复标识符</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html#新编译参数-declarationdir" class="sidebar-link">新编译参数--declarationDir</a></li></ul></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.1.html" class="sidebar-link">TypeScript 2.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.2.html" class="sidebar-link">TypeScript 2.2</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.3.html" class="sidebar-link">TypeScript 2.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.4.html" class="sidebar-link">TypeScript 2.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.5.html" class="sidebar-link">TypeScript 2.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.6.html" class="sidebar-link">TypeScript 2.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.7.html" class="sidebar-link">TypeScript 2.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.1.html" class="sidebar-link">TypeScript 1.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html" class="sidebar-link">TypeScript 2.9</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.0.html" class="sidebar-link">TypeScript 3.0</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.1.html" class="sidebar-link">TypeScript 3.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.2.html" class="sidebar-link">TypeScript 3.2</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.3.html" class="sidebar-link">TypeScript 3.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.4.html" class="sidebar-link">TypeScript 3.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.5.html" class="sidebar-link">TypeScript 3.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.6.html" class="sidebar-link">TypeScript 3.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.7.html" class="sidebar-link">TypeScript 3.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.8.html" class="sidebar-link">TypeScript 3.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.9.html" class="sidebar-link">改进类型推断和Promise.all</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.0.html" class="sidebar-link">可变参元组类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.1.html" class="sidebar-link">模版字面量类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.2.html" class="sidebar-link">更智能地保留类型别名</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.3.html" class="sidebar-link">拆分属性的写入类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html" class="sidebar-link">针对条件表达式和判别式的别名引用进行控制流分析</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="typescript-2-0"><a href="#typescript-2-0" class="header-anchor">#</a> TypeScript 2.0</h1> <h2 id="null和undefined类型"><a href="#null和undefined类型" class="header-anchor">#</a> Null和undefined类型</h2> <p>TypeScript现在有两个特殊的类型：Null和Undefined, 它们的值分别是<code>null</code>和<code>undefined</code>。 以前这是不可能明确地命名这些类型的，但是现在<code>null</code>和<code>undefined</code>不管在什么类型检查模式下都可以作为类型名称使用。</p> <p>以前类型检查器认为<code>null</code>和<code>undefined</code>赋值给一切。实际上，<code>null</code>和<code>undefined</code>是每一个类型的有效值， 并且不能明确排除它们（因此不可能检测到错误）。</p> <h3 id="strictnullchecks"><a href="#strictnullchecks" class="header-anchor">#</a> <code>--strictNullChecks</code></h3> <p><code>--strictNullChecks</code>可以切换到新的严格空检查模式中。</p> <p>在严格空检查模式中，<code>null</code>和<code>undefined</code>值_不再_属于任何类型的值，仅仅属于它们自己类型和<code>any</code>类型的值 （还有一个例外，<code>undefined</code>也能赋值给<code>void</code>）。因此，尽管在常规类型检查模式下<code>T</code>和<code>T | undefined</code>被认为是相同的 （因为<code>undefined</code>被认为是任何<code>T</code>的子类型），但是在严格类型检查模式下它们是不同的， 并且仅仅<code>T | undefined</code>允许有<code>undefined</code>值，<code>T</code>和<code>T | null</code>的关系同样如此。</p> <h4 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 使用--strictNullChecks参数进行编译的</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> z<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
x <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>  <span class="token comment">// 错误</span>
y <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
z <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
x <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// 错误</span>
y <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// 错误</span>
z <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
x <span class="token operator">=</span> y<span class="token punctuation">;</span>  <span class="token comment">// 错误</span>
x <span class="token operator">=</span> z<span class="token punctuation">;</span>  <span class="token comment">// 错误</span>
y <span class="token operator">=</span> x<span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
y <span class="token operator">=</span> z<span class="token punctuation">;</span>  <span class="token comment">// 错误</span>
z <span class="token operator">=</span> x<span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
z <span class="token operator">=</span> y<span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="使用前赋值检查"><a href="#使用前赋值检查" class="header-anchor">#</a> 使用前赋值检查</h3> <p>在严格空检查模式中，编译器要求未包含<code>undefined</code>类型的局部变量在使用之前必须先赋值。</p> <h4 id="示例-2"><a href="#示例-2" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 使用--strictNullChecks参数进行编译</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> z<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
x<span class="token punctuation">;</span>  <span class="token comment">// 错误，使用前未赋值</span>
y<span class="token punctuation">;</span>  <span class="token comment">// 错误，使用前未赋值</span>
z<span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
x<span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
y<span class="token punctuation">;</span>  <span class="token comment">// 正确</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>编译器通过执行_基于控制流的类型分析_检查变量明确被赋过值。在本篇文章后面会有进一步的细节。</p> <h3 id="可选参数和属性"><a href="#可选参数和属性" class="header-anchor">#</a> 可选参数和属性</h3> <p>可选参数和属性会自动把<code>undefined</code>添加到他们的类型中，即使他们的类型注解明确不包含<code>undefined</code>。例如，下面两个类型是完全相同的：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 使用--strictNullChecks参数进行编译</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T1</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token punctuation">;</span>              <span class="token comment">// x的类型是 number | undefined</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T2</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token punctuation">;</span>  <span class="token comment">// x的类型是 number | undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="非null和非undefined类型保护"><a href="#非null和非undefined类型保护" class="header-anchor">#</a> 非null和非undefined类型保护</h3> <p>如果对象或者函数的类型包含<code>null</code>和<code>undefined</code>，那么访问属性或调用函数时就会产生编译错误。因此，对类型保护进行了扩展，以支持对非null和非undefined的检查。</p> <h4 id="示例-3"><a href="#示例-3" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 使用--strictNullChecks参数进行编译</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 正确，这里的x类型是number</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 错误，这里的x类型是number？</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> x <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// a的类型是string</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> x <span class="token operator">&amp;&amp;</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// b的类型是 string | 0 | null | undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>非null和非undefined类型保护可以使用<code>==</code>、<code>!=</code>、<code>===</code>或<code>!==</code>操作符和<code>null</code>或<code>undefined</code>进行比较，如<code>x != null</code>或<code>x === undefined</code>。对被试变量类型的影响准确地反映了JavaScript的语义（比如，双等号运算符检查两个值无论你指定的是null还是undefined，然而三等于号运算符仅仅检查指定的那一个值）。</p> <h3 id="类型保护中的点名称"><a href="#类型保护中的点名称" class="header-anchor">#</a> 类型保护中的点名称</h3> <p>类型保护以前仅仅支持对局部变量和参数的检查。现在类型保护支持检查由变量或参数名称后跟一个或多个访问属性组成的“点名称”。</p> <h4 id="示例-4"><a href="#示例-4" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Options</span> <span class="token punctuation">{</span>
    location<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        x<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
        y<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>options<span class="token operator">?</span><span class="token operator">:</span> Options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>location <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>location<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> x <span class="token operator">=</span> options<span class="token punctuation">.</span>location<span class="token punctuation">.</span>x<span class="token punctuation">;</span>  <span class="token comment">// x的类型是number</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>点名称的类型保护和用户定义的类型保护函数，还有<code>typeof</code>和<code>instanceof</code>操作符一起工作，并且不依赖<code>--strictNullChecks</code>编译参数。</p> <p>对点名称进行类型保护后给点名称任一部分赋值都会导致类型保护无效。例如，对<code>x.y.z</code>进行了类型保护后给<code>x</code>、<code>x.y</code>或<code>x.y.z</code>赋值，都会导致<code>x.y.z</code>类型保护无效。</p> <h3 id="表达式操作符"><a href="#表达式操作符" class="header-anchor">#</a> 表达式操作符</h3> <p>表达式操作符允许运算对象的类型包含<code>null</code>和/或<code>undefined</code>，但是总是产生非null和非undefined类型的结果值。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 使用--strictNullChecks参数进行编译</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token operator">:</span> number <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span> b<span class="token operator">:</span> number <span class="token operator">|</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>  <span class="token comment">// 计算的结果值类型是number</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>&amp;&amp;</code>操作符添加<code>null</code>和/或<code>undefined</code>到右边操作对象的类型中取决于当前左边操作对象的类型，<code>||</code>操作符从左边联合类型的操作对象的类型中将<code>null</code>和<code>undefined</code>同时删除。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 使用--strictNullChecks参数进行编译</span>
<span class="token keyword">interface</span> <span class="token class-name">Entity</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> Entity <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s <span class="token operator">=</span> x <span class="token operator">&amp;&amp;</span> x<span class="token punctuation">.</span>name<span class="token punctuation">;</span>  <span class="token comment">// s的类型是string | null</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> x <span class="token operator">||</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;test&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">// y的类型是Entity</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="类型扩展"><a href="#类型扩展" class="header-anchor">#</a> 类型扩展</h3> <p>在严格空检查模式中，<code>null</code>和<code>undefined</code>类型是_不会_扩展到<code>any</code>类型中的。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">let</span> z <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// z的类型是null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在常规类型检查模式中，由于扩展，会推断<code>z</code>的类型是<code>any</code>，但是在严格空检查模式中，推断<code>z</code>是<code>null</code>类型（因此，如果没有类型注释，<code>null</code>是<code>z</code>的唯一值）。</p> <h3 id="非空断言操作符"><a href="#非空断言操作符" class="header-anchor">#</a> 非空断言操作符</h3> <p>在上下文中当类型检查器无法断定类型时，一个新的后缀表达式操作符<code>!</code>可以用于断言操作对象是非null和非undefined类型的。具体而言，运算<code>x!</code>产生一个不包含<code>null</code>和<code>undefined</code>的<code>x</code>的值。断言的形式类似于<code>&lt;T&gt;x</code>和<code>x as T</code>，<code>!</code>非空断言操作符会从编译成的JavaScript代码中移除。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 使用--strictNullChecks参数进行编译</span>
<span class="token keyword">function</span> <span class="token function">validateEntity</span><span class="token punctuation">(</span>e<span class="token operator">?</span><span class="token operator">:</span> Entity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果e是null或者无效的实体，就会抛出异常</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">processEntity</span><span class="token punctuation">(</span>e<span class="token operator">?</span><span class="token operator">:</span> Entity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">validateEntity</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> s <span class="token operator">=</span> e<span class="token operator">!</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>  <span class="token comment">// 断言e是非空并访问name属性</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="兼容性"><a href="#兼容性" class="header-anchor">#</a> 兼容性</h3> <p>这些新特性是经过设计的，使得它们能够在严格空检查模式和常规类型检查模式下都能够使用。尤其是在常规类型检查模式中，<code>null</code>和<code>undefined</code>类型会自动从联合类型中删除（因为它们是其它所有类型的子类型），<code>!</code>非空断言表达式操作符也被允许使用但是没有任何作用。因此，声明文件使用null和undefined敏感类型更新后，在常规类型模式中仍然是可以向后兼容使用的。</p> <p>在实际应用中，严格空检查模式要求编译的所有文件都是null和undefined敏感类型。</p> <h2 id="基于控制流的类型分析"><a href="#基于控制流的类型分析" class="header-anchor">#</a> 基于控制流的类型分析</h2> <p>TypeScript 2.0实现了对局部变量和参数的控制流类型分析。以前，对类型保护进行类型分析仅限于<code>if</code>语句和<code>?:</code>条件表达式，并且不包括赋值和控制流结构的影响，例如<code>return</code>和<code>break</code>语句。使用TypeScript 2.0，类型检查器会分析语句和表达式所有可能的控制流，在任何指定的位置对声明为联合类型的局部变量或参数产生最可能的具体类型（缩小范围的类型）。</p> <h4 id="示例-5"><a href="#示例-5" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        x<span class="token punctuation">;</span> <span class="token comment">// 这里x的类型是string</span>
        x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        x<span class="token punctuation">;</span> <span class="token comment">// 这里x的类型是number</span>
    <span class="token punctuation">}</span>
    x<span class="token punctuation">;</span> <span class="token comment">// 这里x的类型是number | boolean</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    x<span class="token punctuation">;</span> <span class="token comment">// 这里x的类型是string</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>基于控制流的类型分析在<code>--strictNullChecks</code>模式中尤为重要，因为可空类型使用联合类型来表示：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    x<span class="token punctuation">;</span> <span class="token comment">// 在函数的剩余部分中，x类型是string</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>而且，在<code>--strictNullChecks</code>模式中，基于控制流的分析包括，对类型不允许为<code>undefined</code>的局部变量有_明确赋值_的分析。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">mumble</span><span class="token punctuation">(</span>check<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token comment">// 类型不允许为undefined</span>
    x<span class="token punctuation">;</span> <span class="token comment">// 错误，x是undefined</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>check<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        x<span class="token punctuation">;</span> <span class="token comment">// 正确</span>
    <span class="token punctuation">}</span>
    x<span class="token punctuation">;</span> <span class="token comment">// 错误，x可能是undefi</span>
    x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    x<span class="token punctuation">;</span> <span class="token comment">// 正确</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="标记联合类型"><a href="#标记联合类型" class="header-anchor">#</a> 标记联合类型</h2> <p>TypeScript 2.0实现了标记（或区分）联合类型。具体而言，TS编译器现在支持类型保护，基于判别属性的检查来缩小联合类型的范围，并且<code>switch</code>语句也支持此特性。</p> <h4 id="示例-6"><a href="#示例-6" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Square</span> <span class="token punctuation">{</span>
    kind<span class="token operator">:</span> <span class="token string">&quot;square&quot;</span><span class="token punctuation">;</span>
    size<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    kind<span class="token operator">:</span> <span class="token string">&quot;rectangle&quot;</span><span class="token punctuation">;</span>
    width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Circle</span> <span class="token punctuation">{</span>
    kind<span class="token operator">:</span> <span class="token string">&quot;circle&quot;</span><span class="token punctuation">;</span>
    radius<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Shape</span> <span class="token operator">=</span> Square <span class="token operator">|</span> Rectangle <span class="token operator">|</span> Circle<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span>s<span class="token operator">:</span> Shape<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在下面的switch语句中，s的类型在每一个case中都被缩小</span>
    <span class="token comment">// 根据判别属性的值，变量的其它属性不使用类型断言就可以被访问</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>kind<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&quot;square&quot;</span><span class="token operator">:</span> <span class="token keyword">return</span> s<span class="token punctuation">.</span>size <span class="token operator">*</span> s<span class="token punctuation">.</span>size<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">&quot;rectangle&quot;</span><span class="token operator">:</span> <span class="token keyword">return</span> s<span class="token punctuation">.</span>width <span class="token operator">*</span> s<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">&quot;circle&quot;</span><span class="token operator">:</span> <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> s<span class="token punctuation">.</span>radius <span class="token operator">*</span> s<span class="token punctuation">.</span>radius<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">test1</span><span class="token punctuation">(</span>s<span class="token operator">:</span> Shape<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>kind <span class="token operator">===</span> <span class="token string">&quot;square&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        s<span class="token punctuation">;</span>  <span class="token comment">// Square</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        s<span class="token punctuation">;</span>  <span class="token comment">// Rectangle | Circle</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">test2</span><span class="token punctuation">(</span>s<span class="token operator">:</span> Shape<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>kind <span class="token operator">===</span> <span class="token string">&quot;square&quot;</span> <span class="token operator">||</span> s<span class="token punctuation">.</span>kind <span class="token operator">===</span> <span class="token string">&quot;rectangle&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    s<span class="token punctuation">;</span>  <span class="token comment">// Circle</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>_判别属性类型保护_是<code>x.p == v</code>、<code>x.p === v</code>、<code>x.p != v</code>或者<code>x.p !== v</code>其中的一种表达式，<code>p</code>和<code>v</code>是一个属性和字符串字面量类型或字符串字面量联合类型的表达式。判别属性类型保护缩小<code>x</code>的类型到由判别属性<code>p</code>和<code>v</code>的可能值之一组成的类型。</p> <p>请注意，我们目前只支持字符串字面值类型的判别属性。我们打算以后添加对布尔值和数字字面量类型的支持。</p> <h2 id="never类型"><a href="#never类型" class="header-anchor">#</a> <code>never</code>类型</h2> <p>TypeScript 2.0引入了一个新原始类型<code>never</code>。<code>never</code>类型表示值的类型从不出现。具体而言，<code>never</code>是永不返回函数的返回类型，也是变量在类型保护中永不为true的类型。</p> <p><code>never</code>类型具有以下特征：</p> <ul><li><code>never</code>是所有类型的子类型并且可以赋值给所有类型。</li> <li>没有类型是<code>never</code>的子类型或能赋值给<code>never</code>（<code>never</code>类型本身除外）。</li> <li>在函数表达式或箭头函数没有返回类型注解时，如果函数没有<code>return</code>语句，或者只有<code>never</code>类型表达式的<code>return</code>语句，并且如果函数是不可执行到终点的（例如通过控制流分析决定的），则推断函数的返回类型是<code>never</code>。</li> <li>在有明确<code>never</code>返回类型注解的函数中，所有<code>return</code>语句（如果有的话）必须有<code>never</code>类型的表达式并且函数的终点必须是不可执行的。</li></ul> <p>因为<code>never</code>是每一个类型的子类型，所以它总是在联合类型中被省略，并且在函数中只要其它类型被返回，类型推断就会忽略<code>never</code>类型。</p> <p>一些返回<code>never</code>函数的示例：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 函数返回never必须无法执行到终点</span>
<span class="token keyword">function</span> <span class="token function">error</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">never</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 推断返回类型是never</span>
<span class="token keyword">function</span> <span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;Something failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 函数返回never必须无法执行到终点</span>
<span class="token keyword">function</span> <span class="token function">infiniteLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">never</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>一些函数返回<code>never</code>的使用示例：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 推断返回类型是number</span>
<span class="token keyword">function</span> <span class="token function">move1</span><span class="token punctuation">(</span>direction<span class="token operator">:</span> <span class="token string">&quot;up&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;down&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>direction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&quot;up&quot;</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">&quot;down&quot;</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;Should never get here&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 推断返回类型是number</span>
<span class="token keyword">function</span> <span class="token function">move2</span><span class="token punctuation">(</span>direction<span class="token operator">:</span> <span class="token string">&quot;up&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;down&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> direction <span class="token operator">===</span> <span class="token string">&quot;up&quot;</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span>
        direction <span class="token operator">===</span> <span class="token string">&quot;down&quot;</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span>
        <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;Should never get here&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 推断返回类型是T</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">check</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">||</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;Undefined value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>因为<code>never</code>可以赋值给每一个类型，当需要回调函数返回一个更加具体的类型时，函数返回<code>never</code>类型可以用于检测返回类型是否正确：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token function-variable function">cb</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="只读属性和索引签名"><a href="#只读属性和索引签名" class="header-anchor">#</a> 只读属性和索引签名</h2> <p>属性或索引签名现在可以使用<code>readonly</code>修饰符声明为只读的。</p> <p>只读属性可以初始化和在同一个类的构造函数中被赋值，但是在其它情况下对只读属性的赋值是不允许的。</p> <p>此外，有几种情况下实体_隐式_只读的：</p> <ul><li>属性声明只使用<code>get</code>访问器而没有使用<code>set</code>访问器被视为只读的。</li> <li>在枚举类型中，枚举成员被视为只读属性。</li> <li>在模块类型中，导出的<code>const</code>变量被视为只读属性。</li> <li>在<code>import</code>语句中声明的实体被视为只读的。</li> <li>通过ES2015命名空间导入访问的实体被视为只读的（例如，当<code>foo</code>当作<code>import * as foo from &quot;foo&quot;</code>声明时，<code>foo.x</code>是只读的）。</li></ul> <h4 id="示例-7"><a href="#示例-7" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
    <span class="token keyword">readonly</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    <span class="token keyword">readonly</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> p1<span class="token operator">:</span> Point <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment">// 错误，p1.x是只读的</span>

<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p3<span class="token operator">:</span> Point <span class="token operator">=</span> p2<span class="token punctuation">;</span>  <span class="token comment">// 正确，p2的只读别名</span>
p3<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment">// 错误，p3.x是只读的</span>
p2<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment">// 正确，但是因为别名使用，同时也改变了p3.x</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token keyword">readonly</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">readonly</span> b<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// 在构造函数中允许赋值</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">let</span> a<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b<span class="token operator">:</span> ReadonlyArray<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token operator">=</span> a<span class="token punctuation">;</span>
b<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>      <span class="token comment">// 错误，元素是只读的</span>
b<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 错误，没有push方法（因为这会修改数组）</span>
b<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>  <span class="token comment">// 错误，length是只读的</span>
a <span class="token operator">=</span> b<span class="token punctuation">;</span>         <span class="token comment">// 错误，缺少修改数组的方法</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="指定函数中this类型"><a href="#指定函数中this类型" class="header-anchor">#</a> 指定函数中<code>this</code>类型</h2> <p>紧跟着类和接口，现在函数和方法也可以声明<code>this</code>的类型了。</p> <p>函数中<code>this</code>的默认类型是<code>any</code>。从TypeScript 2.0开始，你可以提供一个明确的<code>this</code>参数。<code>this</code>参数是伪参数，它位于函数参数列表的第一位：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 确保`this`在这个独立的函数中无法使用</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="回调函数中的this参数"><a href="#回调函数中的this参数" class="header-anchor">#</a> 回调函数中的<code>this</code>参数</h3> <p>库也可以使用<code>this</code>参数声明回调函数如何被调用。</p> <h4 id="示例-8"><a href="#示例-8" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">UIElement</span> <span class="token punctuation">{</span>
    <span class="token function">addClickListener</span><span class="token punctuation">(</span><span class="token function-variable function">onclick</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">,</span> e<span class="token operator">:</span> Event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>this:void</code>意味着<code>addClickListener</code>预计<code>onclick</code>是一个<code>this</code>参数不需要类型的函数。</p> <p>现在如果你在调用代码中对<code>this</code>进行了类型注释：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Handler</span> <span class="token punctuation">{</span>
    info<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token function">onClickBad</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> Handler<span class="token punctuation">,</span> e<span class="token operator">:</span> Event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 哎哟，在这里使用this.在运行中使用这个回调函数将会崩溃。</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>info <span class="token operator">=</span> e<span class="token punctuation">.</span>message<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> h <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
uiElement<span class="token punctuation">.</span><span class="token function">addClickListener</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>onClickBad<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 错误！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="noimplicitthis"><a href="#noimplicitthis" class="header-anchor">#</a> <code>--noImplicitThis</code></h3> <p>TypeScript 2.0还增加了一个新的编译选项用来标记函数中所有没有明确类型注释的<code>this</code>的使用。</p> <h2 id="tsconfig-json支持文件通配符"><a href="#tsconfig-json支持文件通配符" class="header-anchor">#</a> <code>tsconfig.json</code>支持文件通配符</h2> <p>文件通配符来啦！！支持文件通配符一直是<a href="https://github.com/Microsoft/TypeScript/issues/1927" target="_blank" rel="noopener noreferrer">最需要的特性之一<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>类似文件通配符的文件模式支持两个属性<code>&quot;include&quot;</code>和<code>&quot;exclude&quot;</code>。</p> <h4 id="示例-9"><a href="#示例-9" class="header-anchor">#</a> 示例</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;noImplicitAny&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">&quot;removeComments&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">&quot;preserveConstEnums&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">&quot;outFile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;../../built/local/tsc.js&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;sourceMap&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;src/**/*&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;**/*.spec.ts&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>支持文件通配符的符号有：</p> <ul><li><code>*</code>匹配零个或多个字符（不包括目录）</li> <li><code>?</code>匹配任意一个字符（不包括目录）</li> <li><code>**/</code>递归匹配所有子目录</li></ul> <p>如果文件通配符模式语句中只包含<code>*</code>或<code>.*</code>，那么只匹配带有扩展名的文件（例如默认是<code>.ts</code>、<code>.tsx</code>和<code>.d.ts</code>，如果<code>allowJs</code>设置为<code>true</code>，<code>.js</code>和<code>.jsx</code>也属于默认）。</p> <p>如果<code>&quot;files&quot;</code>和<code>&quot;include&quot;</code>都没有指定，编译器默认包含所有目录中的TypeScript文件（<code>.ts</code>、<code>.d.ts</code>和<code>.tsx</code>），除了那些使用<code>exclude</code>属性排除的文件外。如果<code>allowJs</code>设置为true，JS文件（<code>.js</code>和<code>.jsx</code>）也会被包含进去。</p> <p>如果<code>&quot;files&quot;</code>和<code>&quot;include&quot;</code>都指定了，编译器将包含这两个属性指定文件的并集。使用<code>ourDir</code>编译选项指定的目录文件总是被排除，即使<code>&quot;exclude&quot;</code>属性指定的文件也会被删除，但是<code>files</code>属性指定的文件不会排除。</p> <p><code>&quot;exclude&quot;</code>属性指定的文件会对<code>&quot;include&quot;</code>属性指定的文件过滤。但是对<code>&quot;files&quot;</code>指定的文件没有任何作用。当没有明确指定时，<code>&quot;exclude&quot;</code>属性默认会排除<code>node_modules</code>、<code>bower_components</code>和<code>jspm_packages</code>目录。</p> <h2 id="模块解析增加-baseurl、路径映射、rootdirs和追踪"><a href="#模块解析增加-baseurl、路径映射、rootdirs和追踪" class="header-anchor">#</a> 模块解析增加：BaseUrl、路径映射、rootDirs和追踪</h2> <p>TypeScript 2.0提供了一系列额外的模块解析属性告诉编译器去哪里可以找到给定模块的声明。</p> <p>更多详情，请参阅<a href="/x-blog/blogs/Typescript/handbook/module-resolution.html">模块解析</a>文档。</p> <h3 id="base-url"><a href="#base-url" class="header-anchor">#</a> Base URL</h3> <p>使用了AMD模块加载器并且模块在运行时”部署“到单文件夹的应用程序中使用<code>baseUrl</code>是一种常用的做法。所有非相对名称的模块导入被认为是相对于<code>baseUrl</code>的。</p> <h4 id="示例-10"><a href="#示例-10" class="header-anchor">#</a> 示例</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./modules&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>现在导入<code>moduleA</code>将会在<code>./modules/moduleA</code>中查找。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token constant">A</span> <span class="token keyword">from</span> <span class="token string">&quot;moduleA&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="路径映射"><a href="#路径映射" class="header-anchor">#</a> 路径映射</h3> <p>有时模块没有直接位于_baseUrl_中。加载器使用映射配置在运行时去映射模块名称和文件，请参阅<a href="http://requirejs.org/docs/api.html#config-paths" target="_blank" rel="noopener noreferrer">RequireJs文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://github.com/systemjs/systemjs/blob/master/docs/overview.md#map-config" target="_blank" rel="noopener noreferrer">SystemJS文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>TypeScript编译器支持<code>tsconfig</code>文件中使用<code>&quot;paths&quot;</code>属性映射的声明。</p> <h4 id="示例-11"><a href="#示例-11" class="header-anchor">#</a> 示例</h4> <p>例如，导入<code>&quot;jquery&quot;</code>模块在运行时会被转换为<code>&quot;node_modules/jquery/dist/jquery.slim.min.js&quot;</code>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./node_modules&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;jquery&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;jquery/dist/jquery.slim.min&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>使用<code>&quot;paths&quot;</code>也允许更复杂的映射，包括多次后退的位置。考虑一个只有一个地方的模块是可用的，其它的模块都在另一个地方的项目配置。</p> <h3 id="rootdirs和虚拟目录"><a href="#rootdirs和虚拟目录" class="header-anchor">#</a> <code>rootDirs</code>和虚拟目录</h3> <p>使用<code>rootDirs</code>，你可以告知编译器的_根目录_组合这些“虚拟”目录。因此编译器在这些“虚拟”目录中解析相对导入模块，仿佛是合并到一个目录中一样。</p> <h4 id="示例-12"><a href="#示例-12" class="header-anchor">#</a> 示例</h4> <p>给定的项目结构</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code> src
 └── views
     └── view1.ts (imports './template1')
     └── view2.ts

 generated
 └── templates
         └── views
             └── template1.ts (imports './view2')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>构建步骤将复制<code>/src/views</code>和<code>/generated/templates/views</code>目录下的文件输出到同一个目录中。在运行时，视图期望它的模板和它存在同一目录中，因此应该使用相对名称<code>&quot;./template&quot;</code>导入。</p> <p><code>&quot;rootDir&quot;</code>指定的一组根目录的内容将会在运行时合并。因此在我们的例子，<code>tsconfig.json</code>文件应该类似于：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;rootDirs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;src/views&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;generated/templates/views&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="追踪模块解析"><a href="#追踪模块解析" class="header-anchor">#</a> 追踪模块解析</h3> <p><code>--traceResolution</code>提供了一种方便的方法，以了解模块如何被编译器解析的。</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>tsc --traceResolution
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="快捷外部模块声明"><a href="#快捷外部模块声明" class="header-anchor">#</a> 快捷外部模块声明</h2> <p>当你使用一个新模块时，如果不想要花费时间书写一个声明时，现在你可以使用快捷声明以便以快速开始。</p> <h4 id="declarations-d-ts"><a href="#declarations-d-ts" class="header-anchor">#</a> declarations.d.ts</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">&quot;hot-new-module&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>所有从快捷模块的导入都具有任意类型。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> x<span class="token punctuation">,</span> <span class="token punctuation">{</span>y<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;hot-new-module&quot;</span><span class="token punctuation">;</span>
<span class="token function">x</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="模块名称中的通配符"><a href="#模块名称中的通配符" class="header-anchor">#</a> 模块名称中的通配符</h2> <p>以前使用模块加载器（例如<a href="https://github.com/amdjs/amdjs-api/blob/master/LoaderPlugins.md" target="_blank" rel="noopener noreferrer">AMD<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://github.com/systemjs/systemjs/blob/master/docs/creating-plugins.md" target="_blank" rel="noopener noreferrer">SystemJS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）导入没有代码的资源是不容易的。之前，必须为每个资源定义一个外部模块声明。</p> <p>TypeScript 2.0支持使用通配符符号（<code>*</code>）定义一类模块名称。这种方式，一个声明只需要一次扩展名，而不再是每一个资源。</p> <h4 id="示例-13"><a href="#示例-13" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">&quot;*!text&quot;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> content<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// Some do it the other way around.</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">&quot;json!*&quot;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>现在你可以导入匹配<code>&quot;*!text&quot;</code>或<code>&quot;json!*&quot;</code>的东西了。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> fileContent <span class="token keyword">from</span> <span class="token string">&quot;./xyz.txt!text&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> data <span class="token keyword">from</span> <span class="token string">&quot;json!http://example.com/data.json&quot;</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> fileContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>当从一个基于非类型化的代码迁移时，通配符模块的名称可能更加有用。结合快捷外部模块声明，一组模块可以很容易地声明为<code>any</code>。</p> <h4 id="示例-14"><a href="#示例-14" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">&quot;myLibrary/*&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>所有位于<code>myLibrary</code>目录之下的模块的导入都被编译器认为是<code>any</code>类型，因此这些模块的任何类型检查都会被关闭。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> readFile <span class="token punctuation">}</span> <span class="token keyword">from</span> &quot;myLibrary<span class="token operator">/</span>fileSystem<span class="token operator">/</span>readFile`<span class="token punctuation">;</span>

<span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// readFile是'any'类型</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="支持umd模块定义"><a href="#支持umd模块定义" class="header-anchor">#</a> 支持UMD模块定义</h2> <p>一些库被设计为可以使用多种模块加载器或者不是使用模块加载器（全局变量）来使用，这被称为<a href="https://github.com/umdjs/umd" target="_blank" rel="noopener noreferrer">UMD<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>或<a href="http://isomorphic.net/" target="_blank" rel="noopener noreferrer">同构<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>模块。这些库可以通过导入或全局变量访问。</p> <p>举例：</p> <p><strong>math-lib.d.ts</strong></p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function">isPrime</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">as</span> <span class="token keyword">namespace</span> mathLib<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后，该库可作为模块导入使用：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> isPrime <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;math-lib&quot;</span><span class="token punctuation">;</span>
<span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mathLib<span class="token punctuation">.</span><span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 错误：无法在模块内部使用全局定义</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>它也可以被用来作为一个全局变量，只限于没有<code>import</code>和<code>export</code>脚本文件中。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>mathLib<span class="token punctuation">.</span><span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="可选类属性"><a href="#可选类属性" class="header-anchor">#</a> 可选类属性</h2> <p>现在可以在类中声明可选属性和方法，与接口类似。</p> <h4 id="示例-15"><a href="#示例-15" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Bar</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    b<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    g<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>  <span class="token comment">// 可选方法的方法体可以省略</span>
    h<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>在<code>--strictNullChecks</code>模式下编译时，可选属性和方法会自动添加<code>undefined</code>到它们的类型中。因此，上面的<code>b</code>属性类型是<code>number | undefined</code>，上面<code>g</code>方法的类型是<code>(()=&gt; number) | undefined</code>。使用类型保护可以去除<code>undefined</code>。</p> <h2 id="私有的和受保护的构造函数"><a href="#私有的和受保护的构造函数" class="header-anchor">#</a> 私有的和受保护的构造函数</h2> <p>类的构造函数可以被标记为<code>private</code>或<code>protected</code>。私有构造函数的类不能在类的外部实例化，并且也不能被继承。受保护构造函数的类不能再类的外部实例化，但是可以被继承。</p> <h4 id="示例-16"><a href="#示例-16" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> instance<span class="token operator">:</span> Singleton<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Singleton<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Singleton<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> Singleton<span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 错误：Singleton的构造函数是私有的。</span>
<span class="token keyword">let</span> v <span class="token operator">=</span> Singleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="抽象属性和访问器"><a href="#抽象属性和访问器" class="header-anchor">#</a> 抽象属性和访问器</h2> <p>抽象类可以声明抽象属性和、或访问器。所有子类将需要声明抽象属性或者被标记为抽象的。抽象属性不能初始化。抽象访问器不能有具体代码块。</p> <h4 id="示例-17"><a href="#示例-17" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
    <span class="token keyword">abstract</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token keyword">abstract</span> <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">abstract</span> <span class="token keyword">set</span> <span class="token function">value</span><span class="token punctuation">(</span>v<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token keyword">extends</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
    name <span class="token operator">=</span> <span class="token string">&quot;derived&quot;</span><span class="token punctuation">;</span>

    value <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="隐式索引签名"><a href="#隐式索引签名" class="header-anchor">#</a> 隐式索引签名</h2> <p>如果对象字面量中所有已知的属性是赋值给索引签名，那么现在对象字面量类型可以赋值给索引签名类型。这使得一个使用对象字面量初始化的变量作为参数传递给期望参数是map或dictionary的函数成为可能：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">httpService</span><span class="token punctuation">(</span>path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> headers<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>x<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

<span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">httpService</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 可以</span>
<span class="token function">httpService</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> headers<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 现在可以，以前不可以。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="使用-lib编译参数包含内置类型声明"><a href="#使用-lib编译参数包含内置类型声明" class="header-anchor">#</a> 使用<code>--lib</code>编译参数包含内置类型声明</h2> <p>获取ES6/ES2015内置API声明仅限于<code>target: ES6</code>。输入<code>--lib</code>，你可以使用<code>--lib</code>指定一组项目所需要的内置API。比如说，如果你希望项目运行时支持<code>Map</code>、<code>Set</code>和<code>Promise</code>（例如现在静默更新浏览器），直接写<code>--lib es2015.collection,es2015.promise</code>就好了。同样，你也可以排除项目中不需要的声明，例如在node项目中使用<code>--lib es5,es6</code>排除DOM。</p> <p>下面是列出了可用的API：</p> <ul><li>dom</li> <li>webworker</li> <li>es5</li> <li>es6 / es2015</li> <li>es2015.core</li> <li>es2015.collection</li> <li>es2015.iterable</li> <li>es2015.promise</li> <li>es2015.proxy</li> <li>es2015.reflect</li> <li>es2015.generator</li> <li>es2015.symbol</li> <li>es2015.symbol.wellknown</li> <li>es2016</li> <li>es2016.array.include</li> <li>es2017</li> <li>es2017.object</li> <li>es2017.sharedmemory</li> <li>scripthost</li></ul> <h4 id="示例-18"><a href="#示例-18" class="header-anchor">#</a> 示例</h4> <div class="language-text line-numbers-mode"><pre class="language-text"><code>tsc --target es5 --lib es5,es2015.promise
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;lib&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;es5&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;es2015.promise&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="使用-nounusedparameters和-nounusedlocals标记未使用的声明"><a href="#使用-nounusedparameters和-nounusedlocals标记未使用的声明" class="header-anchor">#</a> 使用<code>--noUnusedParameters</code>和<code>--noUnusedLocals</code>标记未使用的声明</h2> <p>TypeScript 2.0有两个新的编译参数来帮助你保持一个干净的代码库。<code>-noUnusedParameters</code>编译参数标记所有未使用的函数或方法的参数错误。<code>--noUnusedLocals</code>标记所有未使用的局部（未导出）声明像变量、函数、类和导入等等，另外未使用的私有类成员在<code>--noUnusedLocals</code>作用下也会标记为错误。</p> <h4 id="示例-19"><a href="#示例-19" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token constant">B</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> readFile <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./b&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//     ^ 错误：`B`声明了，但是没有使用。</span>
<span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">write</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> args<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//                                 ^^^^  错误：'arg'声明了，但是没有使用。</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>使用以<code>_</code>开头命名的参数声明不会被未使用参数检查。例如：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">returnNull</span><span class="token punctuation">(</span>_a<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 正确</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="模块名称允许-js扩展名"><a href="#模块名称允许-js扩展名" class="header-anchor">#</a> 模块名称允许<code>.js</code>扩展名</h2> <p>TypeScript 2.0之前，模块名称总是被认为是没有扩展名的。例如，导入一个模块<code>import d from &quot;./moduleA.js&quot;</code>，则编译器在<code>./moduleA.js.ts</code>或<code>./moduleA.js.d.ts</code>中查找<code>&quot;moduleA.js&quot;</code>的定义。这使得像<a href="https://github.com/systemjs/systemjs" target="_blank" rel="noopener noreferrer">SystemJS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这种期望模块名称是URI的打包或加载工具很难使用。</p> <p>使用TypeScript 2.0，编译器将在<code>./moduleA.ts</code>或<code>./moduleA.d.ts</code>中查找<code>&quot;moduleA.js&quot;</code>的定义。</p> <h2 id="支持编译参数target-es5和module-es6同时使用"><a href="#支持编译参数target-es5和module-es6同时使用" class="header-anchor">#</a> 支持编译参数<code>target : es5</code>和<code>module: es6</code>同时使用</h2> <p>之前编译参数<code>target : es5</code>和<code>module: es6</code>同时使用被认为是无效的，但是现在是有效的。这将有助于使用基于ES2015的tree-shaking（将无用代码移除）比如<a href="https://github.com/rollup/rollup" target="_blank" rel="noopener noreferrer">rollup<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="函数形参和实参列表末尾支持逗号"><a href="#函数形参和实参列表末尾支持逗号" class="header-anchor">#</a> 函数形参和实参列表末尾支持逗号</h2> <p>现在函数形参和实参列表末尾允许有逗号。这是对<a href="https://jeffmo.github.io/es-trailing-function-commas/" target="_blank" rel="noopener noreferrer">第三阶段的ECMAScript提案<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的实现, 并且会编译为可用的 ES3/ES5/ES6。</p> <h4 id="示例-20"><a href="#示例-20" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>
  bar<span class="token operator">:</span> Bar<span class="token punctuation">,</span>
  baz<span class="token operator">:</span> Baz<span class="token punctuation">,</span> <span class="token comment">// 形参列表末尾添加逗号是没有问题的。</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 具体实现……</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span>
  bar<span class="token punctuation">,</span>
  baz<span class="token punctuation">,</span> <span class="token comment">// 实参列表末尾添加逗号同样没有问题</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="新编译参数-skiplibcheck"><a href="#新编译参数-skiplibcheck" class="header-anchor">#</a> 新编译参数<code>--skipLibCheck</code></h2> <p>TypeScript 2.0添加了一个新的编译参数<code>--skipLibCheck</code>，该参数可以跳过声明文件（以<code>.d.ts</code>为扩展名的文件）的类型检查。当一个程序包含有大量的声明文件时，编译器需要花费大量时间对已知不包含错误的声明进行类型检查，通过跳过声明文件的类型检查，编译时间可能会大大缩短。</p> <p>由于一个文件中的声明可以影响其他文件中的类型检查，当指定<code>--skipLibCheck</code>时，一些错误可能检测不到。比如说, 如果一个非声明文件中的类型被声明文件用到, 可能仅在声明文件被检查时能发现错误. 不过这种情况在实际使用中并不常见。</p> <h2 id="允许在声明中重复标识符"><a href="#允许在声明中重复标识符" class="header-anchor">#</a> 允许在声明中重复标识符</h2> <p>这是重复定义错误的一个常见来源。多个声明文件定义相同的接口成员。</p> <p>TypeScript 2.0放宽了这一约束，并允许可以不同代码块中出现重复的标识符, 只要它们有_完全相同_的类型。</p> <p>在同一代码块重复定义仍不允许。</p> <h4 id="示例-21"><a href="#示例-21" class="header-anchor">#</a> 示例</h4> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Error</span> <span class="token punctuation">{</span>
    stack<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">interface</span> <span class="token class-name">Error</span> <span class="token punctuation">{</span>
    code<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    path<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    stack<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>  <span class="token comment">// OK</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="新编译参数-declarationdir"><a href="#新编译参数-declarationdir" class="header-anchor">#</a> 新编译参数<code>--declarationDir</code></h2> <p><code>--declarationDir</code>可以使生成的声明文件和JavaScript文件不在同一个位置中。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/xu-ux/x-blog/edit/master/docs/blogs/Typescript/release-notes/typescript-2.0.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">9/7/2021, 14:33:12</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/x-blog/blogs/Typescript/release-notes/typescript-1.8.html" class="prev">
        TypeScript 1.8
      </a></span> <span class="next"><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.1.html">
        TypeScript 2.1
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/x-blog/assets/js/app.ec786a75.js" defer></script><script src="/x-blog/assets/js/19.fd1c5163.js" defer></script><script src="/x-blog/assets/js/1.d44acf8c.js" defer></script><script src="/x-blog/assets/js/2.c1e8940e.js" defer></script><script src="/x-blog/assets/js/108.014ca44d.js" defer></script>
  </body>
</html>
