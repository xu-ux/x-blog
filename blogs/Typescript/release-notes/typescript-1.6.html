<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TypeScript 1.6</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/x-blog/assets/css/0.styles.a8b387b1.css" as="style"><link rel="preload" href="/x-blog/assets/js/app.23c4f710.js" as="script"><link rel="preload" href="/x-blog/assets/js/2.da819b68.js" as="script"><link rel="preload" href="/x-blog/assets/js/99.bbc79558.js" as="script"><link rel="prefetch" href="/x-blog/assets/js/10.25793e01.js"><link rel="prefetch" href="/x-blog/assets/js/100.1977637a.js"><link rel="prefetch" href="/x-blog/assets/js/101.eba0db21.js"><link rel="prefetch" href="/x-blog/assets/js/102.e67ebdcf.js"><link rel="prefetch" href="/x-blog/assets/js/103.1d5e0af2.js"><link rel="prefetch" href="/x-blog/assets/js/104.3929f774.js"><link rel="prefetch" href="/x-blog/assets/js/105.e8e14507.js"><link rel="prefetch" href="/x-blog/assets/js/106.b6d1e284.js"><link rel="prefetch" href="/x-blog/assets/js/107.cdc19914.js"><link rel="prefetch" href="/x-blog/assets/js/108.ecb27e52.js"><link rel="prefetch" href="/x-blog/assets/js/109.81bf166a.js"><link rel="prefetch" href="/x-blog/assets/js/11.3b08d245.js"><link rel="prefetch" href="/x-blog/assets/js/110.75fa3eae.js"><link rel="prefetch" href="/x-blog/assets/js/111.74367cd9.js"><link rel="prefetch" href="/x-blog/assets/js/112.ce0e319a.js"><link rel="prefetch" href="/x-blog/assets/js/113.3aa91524.js"><link rel="prefetch" href="/x-blog/assets/js/114.6bde0457.js"><link rel="prefetch" href="/x-blog/assets/js/115.18988e08.js"><link rel="prefetch" href="/x-blog/assets/js/116.1e92ff83.js"><link rel="prefetch" href="/x-blog/assets/js/117.0f3f5848.js"><link rel="prefetch" href="/x-blog/assets/js/118.f622a832.js"><link rel="prefetch" href="/x-blog/assets/js/119.0f320cac.js"><link rel="prefetch" href="/x-blog/assets/js/12.ddaa2f4a.js"><link rel="prefetch" href="/x-blog/assets/js/120.caa0737b.js"><link rel="prefetch" href="/x-blog/assets/js/121.023c8625.js"><link rel="prefetch" href="/x-blog/assets/js/122.b8c7be7f.js"><link rel="prefetch" href="/x-blog/assets/js/123.2634a2ab.js"><link rel="prefetch" href="/x-blog/assets/js/124.3edaaeb2.js"><link rel="prefetch" href="/x-blog/assets/js/125.eeae4a8f.js"><link rel="prefetch" href="/x-blog/assets/js/126.a2ecc03b.js"><link rel="prefetch" href="/x-blog/assets/js/127.69fdb098.js"><link rel="prefetch" href="/x-blog/assets/js/128.30cf5508.js"><link rel="prefetch" href="/x-blog/assets/js/129.a1afcf02.js"><link rel="prefetch" href="/x-blog/assets/js/13.7454307a.js"><link rel="prefetch" href="/x-blog/assets/js/130.668cc0f3.js"><link rel="prefetch" href="/x-blog/assets/js/131.b3b44ae4.js"><link rel="prefetch" href="/x-blog/assets/js/132.d047e961.js"><link rel="prefetch" href="/x-blog/assets/js/133.7dd84ff2.js"><link rel="prefetch" href="/x-blog/assets/js/134.90ef6c0d.js"><link rel="prefetch" href="/x-blog/assets/js/135.5ded71ee.js"><link rel="prefetch" href="/x-blog/assets/js/136.90b2a527.js"><link rel="prefetch" href="/x-blog/assets/js/137.10d39328.js"><link rel="prefetch" href="/x-blog/assets/js/138.7395e902.js"><link rel="prefetch" href="/x-blog/assets/js/139.36a7731d.js"><link rel="prefetch" href="/x-blog/assets/js/14.62759af3.js"><link rel="prefetch" href="/x-blog/assets/js/140.8514b6bc.js"><link rel="prefetch" href="/x-blog/assets/js/141.56778ca3.js"><link rel="prefetch" href="/x-blog/assets/js/142.00571244.js"><link rel="prefetch" href="/x-blog/assets/js/143.d3e00ad5.js"><link rel="prefetch" href="/x-blog/assets/js/144.9cf0f0ad.js"><link rel="prefetch" href="/x-blog/assets/js/15.875b9a65.js"><link rel="prefetch" href="/x-blog/assets/js/16.a0914b63.js"><link rel="prefetch" href="/x-blog/assets/js/17.f791c512.js"><link rel="prefetch" href="/x-blog/assets/js/18.ceba93c9.js"><link rel="prefetch" href="/x-blog/assets/js/19.bc95d553.js"><link rel="prefetch" href="/x-blog/assets/js/20.ad9e9143.js"><link rel="prefetch" href="/x-blog/assets/js/21.22708bcb.js"><link rel="prefetch" href="/x-blog/assets/js/22.8ec3fb69.js"><link rel="prefetch" href="/x-blog/assets/js/23.c5c865ea.js"><link rel="prefetch" href="/x-blog/assets/js/24.8f06c2bb.js"><link rel="prefetch" href="/x-blog/assets/js/25.503ee2fc.js"><link rel="prefetch" href="/x-blog/assets/js/26.1166aa8a.js"><link rel="prefetch" href="/x-blog/assets/js/27.216a4c52.js"><link rel="prefetch" href="/x-blog/assets/js/28.6530d3f0.js"><link rel="prefetch" href="/x-blog/assets/js/29.72e82756.js"><link rel="prefetch" href="/x-blog/assets/js/3.d8d3bc9a.js"><link rel="prefetch" href="/x-blog/assets/js/30.29107809.js"><link rel="prefetch" href="/x-blog/assets/js/31.0cc8b406.js"><link rel="prefetch" href="/x-blog/assets/js/32.13338c60.js"><link rel="prefetch" href="/x-blog/assets/js/33.ea8b3494.js"><link rel="prefetch" href="/x-blog/assets/js/34.e3d28742.js"><link rel="prefetch" href="/x-blog/assets/js/35.12b320e8.js"><link rel="prefetch" href="/x-blog/assets/js/36.b44bb5c7.js"><link rel="prefetch" href="/x-blog/assets/js/37.4fa27b9e.js"><link rel="prefetch" href="/x-blog/assets/js/38.59f8c99d.js"><link rel="prefetch" href="/x-blog/assets/js/39.02f5b200.js"><link rel="prefetch" href="/x-blog/assets/js/4.302e112e.js"><link rel="prefetch" href="/x-blog/assets/js/40.12e16efa.js"><link rel="prefetch" href="/x-blog/assets/js/41.e26b7b17.js"><link rel="prefetch" href="/x-blog/assets/js/42.ddc901dd.js"><link rel="prefetch" href="/x-blog/assets/js/43.4d1ab6af.js"><link rel="prefetch" href="/x-blog/assets/js/44.915cd1fe.js"><link rel="prefetch" href="/x-blog/assets/js/45.51f58749.js"><link rel="prefetch" href="/x-blog/assets/js/46.91e4591a.js"><link rel="prefetch" href="/x-blog/assets/js/47.8c88c25e.js"><link rel="prefetch" href="/x-blog/assets/js/48.27b8bd7d.js"><link rel="prefetch" href="/x-blog/assets/js/49.4bdc7847.js"><link rel="prefetch" href="/x-blog/assets/js/5.75c1c4c8.js"><link rel="prefetch" href="/x-blog/assets/js/50.bc55da43.js"><link rel="prefetch" href="/x-blog/assets/js/51.aef086ea.js"><link rel="prefetch" href="/x-blog/assets/js/52.023d8419.js"><link rel="prefetch" href="/x-blog/assets/js/53.440aa203.js"><link rel="prefetch" href="/x-blog/assets/js/54.61ecd16e.js"><link rel="prefetch" href="/x-blog/assets/js/55.d3adc26f.js"><link rel="prefetch" href="/x-blog/assets/js/56.3e3118af.js"><link rel="prefetch" href="/x-blog/assets/js/57.64af4f91.js"><link rel="prefetch" href="/x-blog/assets/js/58.d4c0e123.js"><link rel="prefetch" href="/x-blog/assets/js/59.1b2a30b4.js"><link rel="prefetch" href="/x-blog/assets/js/6.64d1cd93.js"><link rel="prefetch" href="/x-blog/assets/js/60.ab4cb31e.js"><link rel="prefetch" href="/x-blog/assets/js/61.c206cf37.js"><link rel="prefetch" href="/x-blog/assets/js/62.6c609148.js"><link rel="prefetch" href="/x-blog/assets/js/63.631814fa.js"><link rel="prefetch" href="/x-blog/assets/js/64.a8b34c2a.js"><link rel="prefetch" href="/x-blog/assets/js/65.54602cfa.js"><link rel="prefetch" href="/x-blog/assets/js/66.a4ebcfb4.js"><link rel="prefetch" href="/x-blog/assets/js/67.eae8e481.js"><link rel="prefetch" href="/x-blog/assets/js/68.f858140e.js"><link rel="prefetch" href="/x-blog/assets/js/69.bb2cc7b7.js"><link rel="prefetch" href="/x-blog/assets/js/7.0f61aaef.js"><link rel="prefetch" href="/x-blog/assets/js/70.29f053ec.js"><link rel="prefetch" href="/x-blog/assets/js/71.8fcf91da.js"><link rel="prefetch" href="/x-blog/assets/js/72.292391ff.js"><link rel="prefetch" href="/x-blog/assets/js/73.bc64b0e8.js"><link rel="prefetch" href="/x-blog/assets/js/74.89c122a8.js"><link rel="prefetch" href="/x-blog/assets/js/75.7c83f756.js"><link rel="prefetch" href="/x-blog/assets/js/76.143ab6fa.js"><link rel="prefetch" href="/x-blog/assets/js/77.78dc477e.js"><link rel="prefetch" href="/x-blog/assets/js/78.336f266d.js"><link rel="prefetch" href="/x-blog/assets/js/79.1b8a8174.js"><link rel="prefetch" href="/x-blog/assets/js/8.186418e2.js"><link rel="prefetch" href="/x-blog/assets/js/80.5c387c5a.js"><link rel="prefetch" href="/x-blog/assets/js/81.468d2443.js"><link rel="prefetch" href="/x-blog/assets/js/82.88851a9c.js"><link rel="prefetch" href="/x-blog/assets/js/83.a5b39e7f.js"><link rel="prefetch" href="/x-blog/assets/js/84.c551e325.js"><link rel="prefetch" href="/x-blog/assets/js/85.12422bf7.js"><link rel="prefetch" href="/x-blog/assets/js/86.bf66847b.js"><link rel="prefetch" href="/x-blog/assets/js/87.7864529e.js"><link rel="prefetch" href="/x-blog/assets/js/88.8ed2a1a3.js"><link rel="prefetch" href="/x-blog/assets/js/89.ca77c00c.js"><link rel="prefetch" href="/x-blog/assets/js/9.50ea345f.js"><link rel="prefetch" href="/x-blog/assets/js/90.864ebaaa.js"><link rel="prefetch" href="/x-blog/assets/js/91.210b8a85.js"><link rel="prefetch" href="/x-blog/assets/js/92.69ada891.js"><link rel="prefetch" href="/x-blog/assets/js/93.57e209ef.js"><link rel="prefetch" href="/x-blog/assets/js/94.b7b84a2c.js"><link rel="prefetch" href="/x-blog/assets/js/95.45e6b2b7.js"><link rel="prefetch" href="/x-blog/assets/js/96.90b784c8.js"><link rel="prefetch" href="/x-blog/assets/js/97.2026a43a.js"><link rel="prefetch" href="/x-blog/assets/js/98.14fa92ed.js">
    <link rel="stylesheet" href="/x-blog/assets/css/0.styles.a8b387b1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/x-blog/" class="home-link router-link-active"><img src="/x-blog/img/logoS.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/x-blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/x-blog/guide/" class="nav-link">
  专栏
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><span class="title">教程</span> <span class="arrow down"></span></button> <button type="button" aria-label="教程" class="mobile-dropdown-title"><span class="title">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/GithubActions/" class="nav-link">
  GithubAction
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/VuePress/" class="nav-link">
  Vuepress
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><span class="title">书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="书籍" class="mobile-dropdown-title"><span class="title">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Typescript/" class="nav-link router-link-active">
  《Typescript》
</a></li></ul></div></div><div class="nav-item"><a href="https://xu-ux.github.io/note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/xu-ux/x-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    仓库
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/x-blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/x-blog/guide/" class="nav-link">
  专栏
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><span class="title">教程</span> <span class="arrow down"></span></button> <button type="button" aria-label="教程" class="mobile-dropdown-title"><span class="title">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/GithubActions/" class="nav-link">
  GithubAction
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/VuePress/" class="nav-link">
  Vuepress
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><span class="title">书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="书籍" class="mobile-dropdown-title"><span class="title">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Typescript/" class="nav-link router-link-active">
  《Typescript》
</a></li></ul></div></div><div class="nav-item"><a href="https://xu-ux.github.io/note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/xu-ux/x-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    仓库
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Release Notes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.8.html" class="sidebar-link">TypeScript 2.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/" aria-current="page" class="sidebar-link">新增功能</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.3.html" class="sidebar-link">TypeScript 1.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.4.html" class="sidebar-link">TypeScript 1.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.5.html" class="sidebar-link">TypeScript 1.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html" aria-current="page" class="active sidebar-link">TypeScript 1.6</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#jsx-支持" class="sidebar-link">JSX 支持</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#新的-tsx-文件扩展名和-as-运算符" class="sidebar-link">新的 .tsx 文件扩展名和 as 运算符</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#使用-react" class="sidebar-link">使用 React</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#使用其他-jsx-框架" class="sidebar-link">使用其他 JSX 框架</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#编译输出" class="sidebar-link">编译输出</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#交叉类型-intersection-types" class="sidebar-link">交叉类型 \(intersection types\)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#例子" class="sidebar-link">例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#本地类型声明" class="sidebar-link">本地类型声明</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#类表达式" class="sidebar-link">类表达式</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#继承表达式" class="sidebar-link">继承表达式</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#abstract-抽象的-类和方法" class="sidebar-link">abstract \(抽象的\) 类和方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#例子-2" class="sidebar-link">例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#泛型别名" class="sidebar-link">泛型别名</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#更严格的对象字面量赋值检查" class="sidebar-link">更严格的对象字面量赋值检查</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#例子-3" class="sidebar-link">例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#es6-生成器-generators" class="sidebar-link">ES6 生成器 \(generators\)</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#对-async-异步-函数的试验性支持" class="sidebar-link">对 async \(异步\) 函数的试验性支持</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#例子-4" class="sidebar-link">例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#每天发布新版本" class="sidebar-link">每天发布新版本</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#对模块解析逻辑的调整" class="sidebar-link">对模块解析逻辑的调整</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#合并外围类和接口的声明" class="sidebar-link">合并外围类和接口的声明</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#用户定义的类型收窄函数" class="sidebar-link">用户定义的类型收窄函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#例子-5" class="sidebar-link">例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#tsconfig-json-对-exclude-属性的支持" class="sidebar-link">tsconfig.json 对 exclude 属性的支持</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html#init-命令行选项" class="sidebar-link">--init 命令行选项</a></li></ul></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.7.html" class="sidebar-link">TypeScript 1.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.8.html" class="sidebar-link">TypeScript 1.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html" class="sidebar-link">TypeScript 2.0</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.1.html" class="sidebar-link">TypeScript 2.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.2.html" class="sidebar-link">TypeScript 2.2</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.3.html" class="sidebar-link">TypeScript 2.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.4.html" class="sidebar-link">TypeScript 2.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.5.html" class="sidebar-link">TypeScript 2.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.6.html" class="sidebar-link">TypeScript 2.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.7.html" class="sidebar-link">TypeScript 2.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.1.html" class="sidebar-link">TypeScript 1.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html" class="sidebar-link">TypeScript 2.9</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.0.html" class="sidebar-link">TypeScript 3.0</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.1.html" class="sidebar-link">TypeScript 3.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.2.html" class="sidebar-link">TypeScript 3.2</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.3.html" class="sidebar-link">TypeScript 3.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.4.html" class="sidebar-link">TypeScript 3.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.5.html" class="sidebar-link">TypeScript 3.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.6.html" class="sidebar-link">TypeScript 3.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.7.html" class="sidebar-link">TypeScript 3.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.8.html" class="sidebar-link">TypeScript 3.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.9.html" class="sidebar-link">改进类型推断和Promise.all</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.0.html" class="sidebar-link">可变参元组类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.1.html" class="sidebar-link">模版字面量类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.2.html" class="sidebar-link">更智能地保留类型别名</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.3.html" class="sidebar-link">拆分属性的写入类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html" class="sidebar-link">针对条件表达式和判别式的别名引用进行控制流分析</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="typescript-1-6"><a href="#typescript-1-6" class="header-anchor">#</a> TypeScript 1.6</h1> <h2 id="jsx-支持"><a href="#jsx-支持" class="header-anchor">#</a> JSX 支持</h2> <p>JSX 是一种可嵌入的类似 XML 的语法. 它将最终被转换为合法的 JavaScript, 但转换的语义和具体实现有关. JSX 随着 React 流行起来, 也出现在其他应用中. TypeScript 1.6 支持 JavaScript 文件中 JSX 的嵌入, 类型检查, 以及直接编译为 JavaScript 的选项.</p> <h3 id="新的-tsx-文件扩展名和-as-运算符"><a href="#新的-tsx-文件扩展名和-as-运算符" class="header-anchor">#</a> 新的 <code>.tsx</code> 文件扩展名和 <code>as</code> 运算符</h3> <p>TypeScript 1.6 引入了新的 <code>.tsx</code> 文件扩展名. 这一扩展名一方面允许 TypeScript 文件中的 JSX 语法, 一方面将 <code>as</code> 运算符作为默认的类型转换方式 (避免 JSX 表达式和 TypeScript 前置类型转换运算符之间的歧义). 比如:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> foo<span class="token punctuation">;</span>
<span class="token comment">// 与如下等价:</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> foo <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="使用-react"><a href="#使用-react" class="header-anchor">#</a> 使用 React</h3> <p>使用 React 及 JSX 支持, 你需要使用 <a href="https://github.com/borisyankov/DefinitelyTyped/tree/master/react" target="_blank" rel="noopener noreferrer">React 类型声明<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. 这些类型定义了 <code>JSX</code> 命名空间, 以便 TypeScript 能正确地检查 React 的 JSX 表达式. 比如:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">/// &lt;reference path=&quot;react.d.ts&quot; /&gt;</span>

<span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component<span class="token operator">&lt;</span>Props<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>foo<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>MyComponent name<span class="token operator">=</span><span class="token string">&quot;bar&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// 没问题</span>
<span class="token operator">&lt;</span>MyComponent name<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// 错误, `name` 不是一个字符串</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="使用其他-jsx-框架"><a href="#使用其他-jsx-框架" class="header-anchor">#</a> 使用其他 JSX 框架</h3> <p>JSX 元素的名称和属性是根据 <code>JSX</code> 命名空间来检验的. 请查看 <a href="https://github.com/Microsoft/TypeScript/wiki/JSX" target="_blank" rel="noopener noreferrer">JSX<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 页面了解如何为自己的框架定义 <code>JSX</code> 命名空间.</p> <h3 id="编译输出"><a href="#编译输出" class="header-anchor">#</a> 编译输出</h3> <p>TypeScript 支持两种 <code>JSX</code> 模式: <code>preserve</code> (保留) 和 <code>react</code>.</p> <ul><li><code>preserve</code> 模式将会在输出中保留 JSX 表达式, 使之后的转换步骤可以处理. <em>并且输出的文件扩展名为 <code>.jsx</code>.</em></li> <li><code>react</code> 模式将会生成 <code>React.createElement</code>, 不再需要再通过 JSX 转换即可运行, 输出的文件扩展名为 <code>.js</code>.</li></ul> <p>查看 <a href="https://github.com/Microsoft/TypeScript/wiki/JSX" target="_blank" rel="noopener noreferrer">JSX<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 页面了解更多 JSX 在 TypeScript 中的使用.</p> <h2 id="交叉类型-intersection-types"><a href="#交叉类型-intersection-types" class="header-anchor">#</a> 交叉类型 (intersection types)</h2> <p>TypeScript 1.6 引入了交叉类型作为联合类型 (union types) 逻辑上的补充. 联合类型 <code>A | B</code> 表示一个类型为 <code>A</code> 或 <code>B</code> 的实体, 而交叉类型 <code>A &amp; B</code> 表示一个类型同时为 <code>A</code> 或 <code>B</code> 的实体.</p> <h3 id="例子"><a href="#例子" class="header-anchor">#</a> 例子</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">extend</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>first<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> second<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> id <span class="token keyword">in</span> first<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> id <span class="token keyword">in</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token string">&quot;hello&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> b<span class="token operator">:</span> <span class="token number">42</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> x<span class="token punctuation">.</span>a<span class="token punctuation">;</span>
<span class="token keyword">var</span> n <span class="token operator">=</span> x<span class="token punctuation">.</span>b<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">LinkedList<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> next<span class="token operator">:</span> LinkedList<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> people<span class="token operator">:</span> LinkedList<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> people<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> people<span class="token punctuation">.</span>next<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> people<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> people<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">A</span></span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">B</span></span> <span class="token punctuation">{</span> b<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span> c<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span>

<span class="token keyword">var</span> abc<span class="token operator">:</span> <span class="token constant">A</span> <span class="token operator">&amp;</span> <span class="token constant">B</span> <span class="token operator">&amp;</span> <span class="token constant">C</span><span class="token punctuation">;</span>
abc<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
abc<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
abc<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>查看 <a href="https://github.com/Microsoft/TypeScript/issues/1256" target="_blank" rel="noopener noreferrer">issue #1256<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 了解更多.</p> <h2 id="本地类型声明"><a href="#本地类型声明" class="header-anchor">#</a> 本地类型声明</h2> <p>本地的类, 接口, 枚举和类型别名现在可以在函数声明中出现. 本地类型为块级作用域, 与 <code>let</code> 和 <code>const</code> 声明的变量类似. 比如说:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">T</span></span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span>
        <span class="token keyword">let</span> v<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
        v<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">T</span></span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span>
        <span class="token keyword">let</span> v<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
        v<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>推导出的函数返回值类型可能在函数内部声明的. 调用函数的地方无法引用到这样的本地类型, 但是它当然能从类型结构上匹配. 比如:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getPointFactory</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name"><span class="token constant">P</span></span> <span class="token punctuation">{</span>
        x <span class="token operator">=</span> x<span class="token punctuation">;</span>
        y <span class="token operator">=</span> y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token constant">P</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> PointZero <span class="token operator">=</span> <span class="token function">getPointFactory</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> PointOne <span class="token operator">=</span> <span class="token function">getPointFactory</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PointZero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PointZero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PointOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>本地的类型可以引用类型参数, 本地的类和接口本身即可能是泛型. 比如:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">f</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">X</span><span class="token punctuation">,</span> <span class="token constant">Y</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">X</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token constant">Y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
            <span class="token keyword">public</span> x <span class="token operator">=</span> x<span class="token punctuation">;</span>
            <span class="token keyword">public</span> y <span class="token operator">=</span> y<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token constant">C</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">C</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> v<span class="token punctuation">.</span>x<span class="token punctuation">;</span>  <span class="token comment">// number</span>
    <span class="token keyword">let</span> y <span class="token operator">=</span> v<span class="token punctuation">.</span>y<span class="token punctuation">;</span>  <span class="token comment">// string</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="类表达式"><a href="#类表达式" class="header-anchor">#</a> 类表达式</h2> <p>TypeScript 1.6 增加了对 ES6 类表达式的支持. 在一个类表达式中, 类的名称是可选的, 如果指明, 作用域仅限于类表达式本身. 这和函数表达式可选的名称类似. 在类表达式外无法引用其实例类型, 但是自然也能够从类型结构上匹配. 比如:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">let</span> Point <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token keyword">public</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// p has anonymous class type</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="继承表达式"><a href="#继承表达式" class="header-anchor">#</a> 继承表达式</h2> <p>TypeScript 1.6 增加了对类继承任意值为一个构造函数的表达式的支持. 这样一来内建的类型也可以在类的声明中被继承.</p> <p><code>extends</code> 语句过去需要指定一个类型引用, 现在接受一个可选类型参数的表达式. 表达式的类型必须为有至少一个构造函数签名的构造函数, 并且需要和 <code>extends</code> 语句中类型参数数量一致. 匹配的构造函数签名的返回值类型是类实例类型继承的基类型. 如此一来, 这使得普通的类和与类相似的表达式可以在 <code>extends</code> 语句中使用.</p> <p>一些例子:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 继承内建类</span>

<span class="token keyword">class</span> <span class="token class-name">MyArray</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">MyError</span> <span class="token keyword">extends</span> <span class="token class-name">Error</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

<span class="token comment">// 继承表达式类</span>

<span class="token keyword">class</span> <span class="token class-name">ThingA</span> <span class="token punctuation">{</span>
    <span class="token function">getGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">&quot;Hello from A&quot;</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ThingB</span> <span class="token punctuation">{</span>
    <span class="token function">getGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">&quot;Hello from B&quot;</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Greeter</span> <span class="token punctuation">{</span>
    <span class="token function">getGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">GreeterConstructor</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Greeter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getGreeterBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> GreeterConstructor <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0.5</span> <span class="token operator">?</span> ThingA <span class="token operator">:</span> ThingB<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token keyword">extends</span> <span class="token class-name">getGreeterBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="abstract-抽象的-类和方法"><a href="#abstract-抽象的-类和方法" class="header-anchor">#</a> <code>abstract</code> (抽象的) 类和方法</h2> <p>TypeScript 1.6 为类和它们的方法增加了 <code>abstract</code> 关键字. 一个抽象类允许没有被实现的方法, 并且不能被构造.</p> <h3 id="例子-2"><a href="#例子-2" class="header-anchor">#</a> 例子</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
    <span class="token keyword">abstract</span> <span class="token function">getThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token function">getOtherThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">'hello'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 错误, 'Base' 是抽象的</span>

<span class="token comment">// 错误, 必须也为抽象类, 或者实现 'getThing' 方法</span>
<span class="token keyword">class</span> <span class="token class-name">Derived1</span> <span class="token keyword">extends</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Derived2</span> <span class="token keyword">extends</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
    <span class="token function">getThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">'hello'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 错误: 不能调用 'super' 的抽象方法</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Derived2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 正确</span>
<span class="token keyword">var</span> y<span class="token operator">:</span> Base <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Derived2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 同样正确</span>
y<span class="token punctuation">.</span><span class="token function">getThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 正确</span>
y<span class="token punctuation">.</span><span class="token function">getOtherThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 正确</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="泛型别名"><a href="#泛型别名" class="header-anchor">#</a> 泛型别名</h2> <p>TypeScript 1.6 中, 类型别名支持泛型. 比如:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Lazy<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> s<span class="token operator">:</span> Lazy<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
s <span class="token operator">=</span> <span class="token string">&quot;eager&quot;</span><span class="token punctuation">;</span>
<span class="token function-variable function">s</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;lazy&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Tuple<span class="token operator">&lt;</span><span class="token constant">A</span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">;</span>
    b<span class="token operator">:</span> <span class="token constant">B</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Pair<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> Tuple<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="更严格的对象字面量赋值检查"><a href="#更严格的对象字面量赋值检查" class="header-anchor">#</a> 更严格的对象字面量赋值检查</h2> <p>为了能发现多余或者错误拼写的属性, TypeScript 1.6 使用了更严格的对象字面量检查. 确切地说, 在将一个新的对象字面量赋值给一个变量, 或者传递给类型非空的参数时, 如果对象字面量的属性在目标类型中不存在, 则会视为错误.</p> <h3 id="例子-3"><a href="#例子-3" class="header-anchor">#</a> 例子</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">var</span> x<span class="token operator">:</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> baz<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">// 错误, 多余的属性 `baz`</span>

<span class="token keyword">var</span> y<span class="token operator">:</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> bar<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> baz<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">// 错误, 多余或者拼错的属性 `baz`</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>一个类型可以通过包含一个索引签名来显示指明未出现在类型中的属性是被允许的.</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">var</span> x<span class="token operator">:</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>x<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> baz<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">// 现在 `baz` 匹配了索引签名</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="es6-生成器-generators"><a href="#es6-生成器-generators" class="header-anchor">#</a> ES6 生成器 (generators)</h2> <p>TypeScript 1.6 添加了对于 ES6 输出的生成器支持.</p> <p>一个生成器函数可以有返回值类型标注, 就像普通的函数. 标注表示生成器函数返回的生成器的类型. 这里有个例子:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Iterable<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">yield</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> <span class="token comment">// string 可以赋值给 string</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">yield</span> <span class="token operator">*</span> <span class="token function">otherStringGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// otherStringGenerator 必须可遍历, 并且元素类型需要可赋值给 string</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>没有标注类型的生成器函数会有自动推演的类型. 在下面的例子中, 类型会由 yield 语句推演出来:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">yield</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 推导出 string</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">yield</span> <span class="token operator">*</span> <span class="token function">otherStringGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 推导出 otherStringGenerator 的元素类型</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="对-async-异步-函数的试验性支持"><a href="#对-async-异步-函数的试验性支持" class="header-anchor">#</a> 对 <code>async</code> (异步) 函数的试验性支持</h2> <p>TypeScript 1.6 增加了编译到 ES6 时对 <code>async</code> 函数试验性的支持. 异步函数会执行一个异步的操作, 在等待的同时不会阻塞程序的正常运行. 这是通过与 ES6 兼容的 <code>Promise</code> 实现完成的, 并且会将函数体转换为支持在等待的异步操作完成时继续的形式.</p> <p>由 <code>async</code> 标记的函数或方法被称作_异步函数_. 这个标记告诉了编译器该函数体需要被转换, 关键字 <em>await</em> 则应该被当做一个一元运算符, 而不是标示符. 一个_异步函数_必须返回类型与 <code>Promise</code> 兼容的值. 返回值类型的推断只能在有一个全局的, 与 ES6 兼容的 <code>Promise</code> 类型时使用.</p> <h3 id="例子-4"><a href="#例子-4" class="header-anchor">#</a> 例子</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">var</span> p<span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token comment">/* ... */</span><span class="token punctuation">;</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token keyword">await</span> p<span class="token punctuation">;</span> <span class="token comment">// 暂停执行直到 'p' 得到结果. 'i' 的类型为 &quot;number&quot;</span>
  <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token keyword">await</span> p<span class="token punctuation">;</span> <span class="token comment">// 暂停执行.</span>
<span class="token keyword">var</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token keyword">await</span> p<span class="token punctuation">;</span> <span class="token comment">// 暂停执行. 使用 --target ES6 选项编译时返回值类型被推断为 &quot;Promise&lt;number&gt;&quot;</span>
<span class="token keyword">var</span> <span class="token function-variable function">fe</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token keyword">await</span> p<span class="token punctuation">;</span> <span class="token comment">// 暂停执行知道 'p' 得到结果. 'i' 的类型为 &quot;number&quot;</span>
  <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token keyword">await</span> p<span class="token punctuation">;</span> <span class="token comment">// 暂停执行知道 'p' 得到结果. 'i' 的类型为 &quot;number&quot;</span>
    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token keyword">get</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token keyword">await</span> p<span class="token punctuation">;</span> <span class="token comment">// 暂停执行知道 'p' 得到结果. 'i' 的类型为 &quot;number&quot;</span>
    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="每天发布新版本"><a href="#每天发布新版本" class="header-anchor">#</a> 每天发布新版本</h2> <p>由于并不算严格意义上的语言变化[2], 每天的新版本可以使用如下命令安装获得:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -g typescript@next
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="对模块解析逻辑的调整"><a href="#对模块解析逻辑的调整" class="header-anchor">#</a> 对模块解析逻辑的调整</h2> <p>从 1.6 开始, TypeScript 编译器对于 &quot;commonjs&quot; 的模块解析会使用一套不同的规则. 这些<a href="https://github.com/Microsoft/TypeScript/issues/2338" target="_blank" rel="noopener noreferrer">规则<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 尝试模仿 Node 查找模块的过程. 这就意味着 node 模块可以包含它的类型信息, 并且 TypeScript 编译器可以找到这些信息. 不过用户可以通过使用 <code>--moduleResolution</code> 命令行选项覆盖模块解析规则. 支持的值有:</p> <ul><li>'classic' - TypeScript 1.6 以前的编译器使用的模块解析规则</li> <li>'node' - 与 node 相似的模块解析</li></ul> <h2 id="合并外围类和接口的声明"><a href="#合并外围类和接口的声明" class="header-anchor">#</a> 合并外围类和接口的声明</h2> <p>外围类的实例类型可以通过接口声明来扩展. 类构造函数对象不会被修改. 比如说:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> x <span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    y <span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span>foo <span class="token operator">:</span> Foo<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
    foo<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 没问题, 在类 Foo 中有声明</span>
    foo<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 没问题, 在接口 Foo 中有声明</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="用户定义的类型收窄函数"><a href="#用户定义的类型收窄函数" class="header-anchor">#</a> 用户定义的类型收窄函数</h2> <p>TypeScript 1.6 增加了一个新的在 <code>if</code> 语句中收窄变量类型的方式, 作为对 <code>typeof</code> 和 <code>instanceof</code> 的补充. 用户定义的类型收窄函数的返回值类型标注形式为 <code>x is T</code>, 这里 <code>x</code> 是函数声明中的形参, <code>T</code> 是任何类型. 当一个用户定义的类型收窄函数在 <code>if</code> 语句中被传入某个变量执行时, 该变量的类型会被收窄到 <code>T</code>.</p> <h3 id="例子-5"><a href="#例子-5" class="header-anchor">#</a> 例子</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">isCat</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> a <span class="token keyword">is</span> Cat <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'kitty'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> x<span class="token operator">:</span> Cat <span class="token operator">|</span> Dog<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isCat</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  x<span class="token punctuation">.</span><span class="token function">meow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 那么, x 在这个代码块内是 Cat 类型</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="tsconfig-json-对-exclude-属性的支持"><a href="#tsconfig-json-对-exclude-属性的支持" class="header-anchor">#</a> <code>tsconfig.json</code> 对 <code>exclude</code> 属性的支持</h2> <p>一个没有写明 <code>files</code> 属性的 <code>tsconfig.json</code> 文件 (默认会引用所有子目录下的 *.ts 文件) 现在可以包含一个 <code>exclude</code> 属性, 指定需要在编译中排除的文件或者目录列表. <code>exclude</code> 属性必须是一个字符串数组, 其中每一个元素指定对应的一个文件或者文件夹名称对于 <code>tsconfig.json</code> 文件所在位置的相对路径. 举例来说:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;out&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test.js&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;test.ts&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;utils/t2.ts&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>exclude</code> 列表不支持通配符. 仅仅可以是文件或者目录的列表.</p> <h2 id="init-命令行选项"><a href="#init-命令行选项" class="header-anchor">#</a> <code>--init</code> 命令行选项</h2> <p>在一个目录中执行 <code>tsc --init</code> 可以在该目录中创建一个包含了默认值的 <code>tsconfig.json</code>. 可以通过一并传递其他选项来生成初始的 <code>tsconfig.json</code>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/xu-ux/x-blog/edit/master/docs/blogs/Typescript/release-notes/typescript-1.6.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">9/7/2021, 14:33:12</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/x-blog/blogs/Typescript/release-notes/typescript-1.5.html" class="prev">
        TypeScript 1.5
      </a></span> <span class="next"><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.7.html">
        TypeScript 1.7
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/x-blog/assets/js/app.23c4f710.js" defer></script><script src="/x-blog/assets/js/2.da819b68.js" defer></script><script src="/x-blog/assets/js/99.bbc79558.js" defer></script>
  </body>
</html>
