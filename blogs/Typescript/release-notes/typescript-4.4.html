<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>针对条件表达式和判别式的别名引用进行控制流分析</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/x-blog/assets/css/0.styles.f545f826.css" as="style"><link rel="preload" href="/x-blog/assets/js/app.ce19e263.js" as="script"><link rel="preload" href="/x-blog/assets/js/19.c6894ce7.js" as="script"><link rel="preload" href="/x-blog/assets/js/1.b6d07039.js" as="script"><link rel="preload" href="/x-blog/assets/js/2.9af08480.js" as="script"><link rel="preload" href="/x-blog/assets/js/132.52e9668e.js" as="script"><link rel="prefetch" href="/x-blog/assets/js/10.9a001f39.js"><link rel="prefetch" href="/x-blog/assets/js/100.c1e3cef1.js"><link rel="prefetch" href="/x-blog/assets/js/101.7356a8b8.js"><link rel="prefetch" href="/x-blog/assets/js/102.2e3a0e14.js"><link rel="prefetch" href="/x-blog/assets/js/103.e9de3105.js"><link rel="prefetch" href="/x-blog/assets/js/104.2a9f216d.js"><link rel="prefetch" href="/x-blog/assets/js/105.9604e567.js"><link rel="prefetch" href="/x-blog/assets/js/106.bd7ba0a4.js"><link rel="prefetch" href="/x-blog/assets/js/107.b5b86704.js"><link rel="prefetch" href="/x-blog/assets/js/108.9de56e21.js"><link rel="prefetch" href="/x-blog/assets/js/109.8c932b4a.js"><link rel="prefetch" href="/x-blog/assets/js/11.dd001fe3.js"><link rel="prefetch" href="/x-blog/assets/js/110.72809c47.js"><link rel="prefetch" href="/x-blog/assets/js/111.76e619e8.js"><link rel="prefetch" href="/x-blog/assets/js/112.45f74c7b.js"><link rel="prefetch" href="/x-blog/assets/js/113.0bd27206.js"><link rel="prefetch" href="/x-blog/assets/js/114.61eb0a3e.js"><link rel="prefetch" href="/x-blog/assets/js/115.8473b4ed.js"><link rel="prefetch" href="/x-blog/assets/js/116.80003a9b.js"><link rel="prefetch" href="/x-blog/assets/js/117.5e5eab30.js"><link rel="prefetch" href="/x-blog/assets/js/118.955b5e8d.js"><link rel="prefetch" href="/x-blog/assets/js/119.ad76dce9.js"><link rel="prefetch" href="/x-blog/assets/js/12.3df795f8.js"><link rel="prefetch" href="/x-blog/assets/js/120.d6dfdb46.js"><link rel="prefetch" href="/x-blog/assets/js/121.1637b815.js"><link rel="prefetch" href="/x-blog/assets/js/122.a9f06c80.js"><link rel="prefetch" href="/x-blog/assets/js/123.ac8e2b75.js"><link rel="prefetch" href="/x-blog/assets/js/124.f692519e.js"><link rel="prefetch" href="/x-blog/assets/js/125.52c5347b.js"><link rel="prefetch" href="/x-blog/assets/js/126.e90ae4a7.js"><link rel="prefetch" href="/x-blog/assets/js/127.b29c2cb6.js"><link rel="prefetch" href="/x-blog/assets/js/128.666ce20f.js"><link rel="prefetch" href="/x-blog/assets/js/129.65955d67.js"><link rel="prefetch" href="/x-blog/assets/js/13.b71de5d9.js"><link rel="prefetch" href="/x-blog/assets/js/130.bf159c92.js"><link rel="prefetch" href="/x-blog/assets/js/131.801bfc0b.js"><link rel="prefetch" href="/x-blog/assets/js/133.8001da49.js"><link rel="prefetch" href="/x-blog/assets/js/134.8bd28716.js"><link rel="prefetch" href="/x-blog/assets/js/135.626789f0.js"><link rel="prefetch" href="/x-blog/assets/js/136.d47d4c0e.js"><link rel="prefetch" href="/x-blog/assets/js/137.beb02df1.js"><link rel="prefetch" href="/x-blog/assets/js/138.fd410778.js"><link rel="prefetch" href="/x-blog/assets/js/139.34279614.js"><link rel="prefetch" href="/x-blog/assets/js/14.6eaf08d1.js"><link rel="prefetch" href="/x-blog/assets/js/140.42af3f88.js"><link rel="prefetch" href="/x-blog/assets/js/141.1392c971.js"><link rel="prefetch" href="/x-blog/assets/js/142.97301e74.js"><link rel="prefetch" href="/x-blog/assets/js/143.a60d776e.js"><link rel="prefetch" href="/x-blog/assets/js/144.6234cee3.js"><link rel="prefetch" href="/x-blog/assets/js/145.57e9772b.js"><link rel="prefetch" href="/x-blog/assets/js/146.95da0439.js"><link rel="prefetch" href="/x-blog/assets/js/147.2e33632d.js"><link rel="prefetch" href="/x-blog/assets/js/148.d577da72.js"><link rel="prefetch" href="/x-blog/assets/js/149.ea94b2bd.js"><link rel="prefetch" href="/x-blog/assets/js/15.84d226b0.js"><link rel="prefetch" href="/x-blog/assets/js/150.ab58329f.js"><link rel="prefetch" href="/x-blog/assets/js/16.ecf59569.js"><link rel="prefetch" href="/x-blog/assets/js/17.ffa9dd1d.js"><link rel="prefetch" href="/x-blog/assets/js/18.6fea2f8d.js"><link rel="prefetch" href="/x-blog/assets/js/20.fe3e9eb0.js"><link rel="prefetch" href="/x-blog/assets/js/21.853756df.js"><link rel="prefetch" href="/x-blog/assets/js/22.5d647f90.js"><link rel="prefetch" href="/x-blog/assets/js/23.627c86b8.js"><link rel="prefetch" href="/x-blog/assets/js/24.b81eef0e.js"><link rel="prefetch" href="/x-blog/assets/js/25.693859ea.js"><link rel="prefetch" href="/x-blog/assets/js/26.41e3a375.js"><link rel="prefetch" href="/x-blog/assets/js/27.cab70cbe.js"><link rel="prefetch" href="/x-blog/assets/js/28.c27de334.js"><link rel="prefetch" href="/x-blog/assets/js/29.75a592fb.js"><link rel="prefetch" href="/x-blog/assets/js/30.250d3001.js"><link rel="prefetch" href="/x-blog/assets/js/31.9333687e.js"><link rel="prefetch" href="/x-blog/assets/js/32.a59f9f81.js"><link rel="prefetch" href="/x-blog/assets/js/33.879f5c3f.js"><link rel="prefetch" href="/x-blog/assets/js/34.191eb799.js"><link rel="prefetch" href="/x-blog/assets/js/35.dd613e7e.js"><link rel="prefetch" href="/x-blog/assets/js/36.0687e131.js"><link rel="prefetch" href="/x-blog/assets/js/37.8134470e.js"><link rel="prefetch" href="/x-blog/assets/js/38.d2adfc8f.js"><link rel="prefetch" href="/x-blog/assets/js/39.5c87d452.js"><link rel="prefetch" href="/x-blog/assets/js/4.55661e0d.js"><link rel="prefetch" href="/x-blog/assets/js/40.0f8f1380.js"><link rel="prefetch" href="/x-blog/assets/js/41.92f744ea.js"><link rel="prefetch" href="/x-blog/assets/js/42.dc6b8f90.js"><link rel="prefetch" href="/x-blog/assets/js/43.9c002ce6.js"><link rel="prefetch" href="/x-blog/assets/js/44.2cead760.js"><link rel="prefetch" href="/x-blog/assets/js/45.2d6a244b.js"><link rel="prefetch" href="/x-blog/assets/js/46.a516de3b.js"><link rel="prefetch" href="/x-blog/assets/js/47.d3ebf89f.js"><link rel="prefetch" href="/x-blog/assets/js/48.96fa85df.js"><link rel="prefetch" href="/x-blog/assets/js/49.0ddfa874.js"><link rel="prefetch" href="/x-blog/assets/js/5.0d8f928e.js"><link rel="prefetch" href="/x-blog/assets/js/50.4a328f8e.js"><link rel="prefetch" href="/x-blog/assets/js/51.851e49e1.js"><link rel="prefetch" href="/x-blog/assets/js/52.105e6b85.js"><link rel="prefetch" href="/x-blog/assets/js/53.0110d45b.js"><link rel="prefetch" href="/x-blog/assets/js/54.7ccbc7fc.js"><link rel="prefetch" href="/x-blog/assets/js/55.b0170063.js"><link rel="prefetch" href="/x-blog/assets/js/56.71d1f8f2.js"><link rel="prefetch" href="/x-blog/assets/js/57.c4904882.js"><link rel="prefetch" href="/x-blog/assets/js/58.e0683e03.js"><link rel="prefetch" href="/x-blog/assets/js/59.abadfb69.js"><link rel="prefetch" href="/x-blog/assets/js/6.dd4b917e.js"><link rel="prefetch" href="/x-blog/assets/js/60.f3446587.js"><link rel="prefetch" href="/x-blog/assets/js/61.ab5f3c94.js"><link rel="prefetch" href="/x-blog/assets/js/62.27acc504.js"><link rel="prefetch" href="/x-blog/assets/js/63.cd2d3861.js"><link rel="prefetch" href="/x-blog/assets/js/64.9de0f30a.js"><link rel="prefetch" href="/x-blog/assets/js/65.e53abbae.js"><link rel="prefetch" href="/x-blog/assets/js/66.49b524b0.js"><link rel="prefetch" href="/x-blog/assets/js/67.7d795035.js"><link rel="prefetch" href="/x-blog/assets/js/68.85e499d6.js"><link rel="prefetch" href="/x-blog/assets/js/69.c4160a06.js"><link rel="prefetch" href="/x-blog/assets/js/7.05fc1b0f.js"><link rel="prefetch" href="/x-blog/assets/js/70.4fb4f663.js"><link rel="prefetch" href="/x-blog/assets/js/71.ab4ce34d.js"><link rel="prefetch" href="/x-blog/assets/js/72.6fb98f0b.js"><link rel="prefetch" href="/x-blog/assets/js/73.78a12f47.js"><link rel="prefetch" href="/x-blog/assets/js/74.5215b4fa.js"><link rel="prefetch" href="/x-blog/assets/js/75.01d79b5d.js"><link rel="prefetch" href="/x-blog/assets/js/76.12a2ebe0.js"><link rel="prefetch" href="/x-blog/assets/js/77.959bd53d.js"><link rel="prefetch" href="/x-blog/assets/js/78.28411fac.js"><link rel="prefetch" href="/x-blog/assets/js/79.b7bf8f4c.js"><link rel="prefetch" href="/x-blog/assets/js/8.345d7ee5.js"><link rel="prefetch" href="/x-blog/assets/js/80.e68195d4.js"><link rel="prefetch" href="/x-blog/assets/js/81.ad41fb92.js"><link rel="prefetch" href="/x-blog/assets/js/82.e3035738.js"><link rel="prefetch" href="/x-blog/assets/js/83.0d3e1363.js"><link rel="prefetch" href="/x-blog/assets/js/84.80bd2d21.js"><link rel="prefetch" href="/x-blog/assets/js/85.616b94eb.js"><link rel="prefetch" href="/x-blog/assets/js/86.b56b6314.js"><link rel="prefetch" href="/x-blog/assets/js/87.afea378d.js"><link rel="prefetch" href="/x-blog/assets/js/88.d156f918.js"><link rel="prefetch" href="/x-blog/assets/js/89.0119b6c1.js"><link rel="prefetch" href="/x-blog/assets/js/9.ffd18474.js"><link rel="prefetch" href="/x-blog/assets/js/90.11ad4d4b.js"><link rel="prefetch" href="/x-blog/assets/js/91.5112501b.js"><link rel="prefetch" href="/x-blog/assets/js/92.966869dd.js"><link rel="prefetch" href="/x-blog/assets/js/93.f14e8cbc.js"><link rel="prefetch" href="/x-blog/assets/js/94.caa02c63.js"><link rel="prefetch" href="/x-blog/assets/js/95.d1e4a136.js"><link rel="prefetch" href="/x-blog/assets/js/96.ed4f74ef.js"><link rel="prefetch" href="/x-blog/assets/js/97.837b60e9.js"><link rel="prefetch" href="/x-blog/assets/js/98.95ae9cb7.js"><link rel="prefetch" href="/x-blog/assets/js/99.512af8eb.js">
    <link rel="stylesheet" href="/x-blog/assets/css/0.styles.f545f826.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/x-blog/" class="home-link router-link-active"><img src="/x-blog/img/logoS.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/x-blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/x-blog/guide/" class="nav-link">
  专栏
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><span class="title">教程</span> <span class="arrow down"></span></button> <button type="button" aria-label="教程" class="mobile-dropdown-title"><span class="title">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/GithubActions/" class="nav-link">
  GithubAction
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/VuePress/" class="nav-link">
  Vuepress
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><span class="title">书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="书籍" class="mobile-dropdown-title"><span class="title">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Typescript/" class="nav-link router-link-active">
  《Typescript》
</a></li></ul></div></div><div class="nav-item"><a href="https://xu-ux.github.io/note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/xu-ux/x-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    仓库
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/x-blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/x-blog/guide/" class="nav-link">
  专栏
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><span class="title">教程</span> <span class="arrow down"></span></button> <button type="button" aria-label="教程" class="mobile-dropdown-title"><span class="title">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/GithubActions/" class="nav-link">
  GithubAction
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/VuePress/" class="nav-link">
  Vuepress
</a></li><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><span class="title">书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="书籍" class="mobile-dropdown-title"><span class="title">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x-blog/blogs/Typescript/" class="nav-link router-link-active">
  《Typescript》
</a></li></ul></div></div><div class="nav-item"><a href="https://xu-ux.github.io/note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/xu-ux/x-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    仓库
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Release Notes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.8.html" class="sidebar-link">TypeScript 2.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/" aria-current="page" class="sidebar-link">新增功能</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.3.html" class="sidebar-link">TypeScript 1.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.4.html" class="sidebar-link">TypeScript 1.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.5.html" class="sidebar-link">TypeScript 1.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.6.html" class="sidebar-link">TypeScript 1.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.7.html" class="sidebar-link">TypeScript 1.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.8.html" class="sidebar-link">TypeScript 1.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.0.html" class="sidebar-link">TypeScript 2.0</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.1.html" class="sidebar-link">TypeScript 2.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.2.html" class="sidebar-link">TypeScript 2.2</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.3.html" class="sidebar-link">TypeScript 2.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.4.html" class="sidebar-link">TypeScript 2.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.5.html" class="sidebar-link">TypeScript 2.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.6.html" class="sidebar-link">TypeScript 2.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.7.html" class="sidebar-link">TypeScript 2.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-1.1.html" class="sidebar-link">TypeScript 1.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-2.9.html" class="sidebar-link">TypeScript 2.9</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.0.html" class="sidebar-link">TypeScript 3.0</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.1.html" class="sidebar-link">TypeScript 3.1</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.2.html" class="sidebar-link">TypeScript 3.2</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.3.html" class="sidebar-link">TypeScript 3.3</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.4.html" class="sidebar-link">TypeScript 3.4</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.5.html" class="sidebar-link">TypeScript 3.5</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.6.html" class="sidebar-link">TypeScript 3.6</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.7.html" class="sidebar-link">TypeScript 3.7</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.8.html" class="sidebar-link">TypeScript 3.8</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-3.9.html" class="sidebar-link">改进类型推断和Promise.all</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.0.html" class="sidebar-link">可变参元组类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.1.html" class="sidebar-link">模版字面量类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.2.html" class="sidebar-link">更智能地保留类型别名</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.3.html" class="sidebar-link">拆分属性的写入类型</a></li><li><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html" aria-current="page" class="active sidebar-link">针对条件表达式和判别式的别名引用进行控制流分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#针对条件表达式和判别式的别名引用进行控制流分析" class="sidebar-link">针对条件表达式和判别式的别名引用进行控制流分析</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#symbol-以及模版字符串索引签名" class="sidebar-link">Symbol 以及模版字符串索引签名</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#defaulting-to-the-unknown-type-in-catch-variables-useunknownincatchvariables" class="sidebar-link">Defaulting to the unknown Type in Catch Variables (--useUnknownInCatchVariables)</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#exact-optional-property-types-exactoptionalpropertytypes" class="sidebar-link">Exact Optional Property Types (--exactOptionalPropertyTypes)</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#static-blocks-in-classes" class="sidebar-link">static Blocks in Classes</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#tsc-help-updates-and-improvements" class="sidebar-link">tsc --help Updates and Improvements</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#performance-improvements" class="sidebar-link">Performance Improvements</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#faster-declaration-emit" class="sidebar-link">Faster Declaration Emit</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#faster-path-normalization" class="sidebar-link">Faster Path Normalization</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#faster-path-mapping" class="sidebar-link">Faster Path Mapping</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#faster-incremental-builds-with-strict" class="sidebar-link">Faster Incremental Builds with --strict</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#faster-source-map-generation-for-big-outputs" class="sidebar-link">Faster Source Map Generation for Big Outputs</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#faster-force-builds" class="sidebar-link">Faster --force Builds</a></li></ul></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#spelling-suggestions-for-javascript" class="sidebar-link">Spelling Suggestions for JavaScript</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#inlay-hints" class="sidebar-link">Inlay Hints</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#auto-imports-show-true-paths-in-completion-lists" class="sidebar-link">Auto-Imports Show True Paths in Completion Lists</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#breaking-changes" class="sidebar-link">Breaking Changes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#lib-d-ts-changes-for-typescript-4-4" class="sidebar-link">lib.d.ts Changes for TypeScript 4.4</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#more-compliant-indirect-calls-for-imported-functions" class="sidebar-link">More-Compliant Indirect Calls for Imported Functions</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#using-unknown-in-catch-variables" class="sidebar-link">Using unknown in Catch Variables</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#broader-always-truthy-promise-checks" class="sidebar-link">Broader Always-Truthy Promise Checks</a></li><li class="sidebar-sub-header"><a href="/x-blog/blogs/Typescript/release-notes/typescript-4.4.html#abstract-properties-do-not-allow-initializers" class="sidebar-link">Abstract Properties Do Not Allow Initializers</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="针对条件表达式和判别式的别名引用进行控制流分析"><a href="#针对条件表达式和判别式的别名引用进行控制流分析" class="header-anchor">#</a> 针对条件表达式和判别式的别名引用进行控制流分析</h2> <p>在 JavaScript 中，总会用多种方式对某个值进行检查，然后根据不同类型的值执行不同的操作。
TypeScript 能够理解这些检查，并将它们称作为<em>类型守卫</em>。
我们不需要在变量的每一个使用位置上都指明类型，TypeScript 的类型检查器能够利用<em>基于控制流的分析</em>技术来检查是否在前面使用了类型守卫。</p> <p>例如，可以这样写</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> arg <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//           ^?</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这个例子中，我们检查 <code>arg</code> 是否为 <code>string</code> 类型。
TypeScript 识别出了 <code>typeof arg === &quot;string&quot;</code> 检查，它被当作是一个类型守卫，并且知道在 <code>if</code> 分支内 <code>arg</code> 的类型为 <code>string</code>。
这样就可以正常地访问 <code>string</code> 类型上的方法，例如 <code>toUpperCase()</code>。</p> <p>但如果我们将条件表达式提取到一个名为 <code>argIsString</code> 的常量会发生什么？</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// 在 TS 4.3 及以下版本</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> argIsString <span class="token operator">=</span> <span class="token keyword">typeof</span> arg <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>argIsString<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//              ~~~~~~~~~~~</span>
        <span class="token comment">// 错误！'unknown' 类型上不存在 'toUpperCase' 属性。</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>在之前版本的 TypeScript 中，这样做会产生错误 - 就算 <code>argIsString</code> 的值为类型守卫，TypeScript 也会丢掉这个信息。
这不是想要的结果，因为我们可能想要在不同的地方重用这个检查。
为了绕过这个问题，通常需要重复多次代码或使用类型断言。</p> <p>在 TypeScript 4.4 中，情况有所改变。
上面的例子不再产生错误！
当 TypeScript 看到我们在检查一个常量时，会额外检查它是否包含类型守卫。
如果那个类型守卫操作的是 <code>const</code> 常量，某个 <code>readonly</code> 属性或某个未修改的参数，那么 TypeScript 能够对该值进行类型细化。</p> <p>不同种类的类型守卫都支持，不只是 <code>typeof</code> 类型守卫。
例如，对于可辨识联合类型同样适用。</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Shape</span> <span class="token operator">=</span>
    <span class="token operator">|</span> <span class="token punctuation">{</span> kind<span class="token operator">:</span> <span class="token string">'circle'</span><span class="token punctuation">;</span> radius<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token punctuation">{</span> kind<span class="token operator">:</span> <span class="token string">'square'</span><span class="token punctuation">;</span> sideLength<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span>shape<span class="token operator">:</span> Shape<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> isCircle <span class="token operator">=</span> shape<span class="token punctuation">.</span>kind <span class="token operator">===</span> <span class="token string">'circle'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isCircle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 知道此处为 circle</span>
        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> shape<span class="token punctuation">.</span>radius <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 知道此处为 square</span>
        <span class="token keyword">return</span> shape<span class="token punctuation">.</span>sideLength <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>在 TypeScript 4.4 版本中对判别式的分析又进了一层 - 现在可以提取出判别式然后细化原来的对象类型。</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Shape</span> <span class="token operator">=</span>
    <span class="token operator">|</span> <span class="token punctuation">{</span> kind<span class="token operator">:</span> <span class="token string">'circle'</span><span class="token punctuation">;</span> radius<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token punctuation">{</span> kind<span class="token operator">:</span> <span class="token string">'square'</span><span class="token punctuation">;</span> sideLength<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span>shape<span class="token operator">:</span> Shape<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
    <span class="token comment">// Extract out the 'kind' field first.</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> kind <span class="token punctuation">}</span> <span class="token operator">=</span> shape<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>kind <span class="token operator">===</span> <span class="token string">'circle'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// We know we have a circle here!</span>
        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> shape<span class="token punctuation">.</span>radius <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// We know we're left with a square here!</span>
        <span class="token keyword">return</span> shape<span class="token punctuation">.</span>sideLength <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>另一个例子，该函数会检查它的两个参数是否有内容。</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">doSomeChecks</span><span class="token punctuation">(</span>
    inputA<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    inputB<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    shouldDoExtraWork<span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mustDoWork <span class="token operator">=</span> inputA <span class="token operator">&amp;&amp;</span> inputB <span class="token operator">&amp;&amp;</span> shouldDoExtraWork<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mustDoWork<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// We can access 'string' properties on both 'inputA' and 'inputB'!</span>
        <span class="token keyword">const</span> upperA <span class="token operator">=</span> inputA<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> upperB <span class="token operator">=</span> inputB<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>TypeScript 知道如果 <code>mustDoWork</code> 为 <code>true</code> 那么 <code>inputA</code> 和 <code>inputB</code> 都存在。
也就是说不需要编写像 <code>inputA!</code> 这样的非空断言的代码来告诉 TypeScript <code>inputA</code> 不为 <code>undefined</code>。</p> <p>一个好的性质是该分析同时具有可传递性。
TypeScript 可以通过这些常量来理解在它们背后执行的检查。</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> isString <span class="token operator">=</span> <span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> isNumber <span class="token operator">=</span> <span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> isStringOrNumber <span class="token operator">=</span> isString <span class="token operator">||</span> isNumber<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isStringOrNumber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        x<span class="token punctuation">;</span>
        <span class="token comment">//  ^?</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        x<span class="token punctuation">;</span>
        <span class="token comment">//  ^?</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>注意这里会有一个截点 - TypeScript 并不是毫无限制地去追溯检查这些条件表达式，但对于大多数使用场景而言已经足够了。</p> <p>这个功能能让很多直观的 JavaScript 代码在 TypeScript 里也好用，而不会妨碍我们。
更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/44730" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>！</p> <h2 id="symbol-以及模版字符串索引签名"><a href="#symbol-以及模版字符串索引签名" class="header-anchor">#</a> Symbol 以及模版字符串索引签名</h2> <p>TypeScript 支持使用<em>索引签名</em>来为对象的每个属性定义类型。
这样我们就可以将对象当作字典类型来使用，把字符串放在方括号里来进行索引。</p> <p>例如，可以编写由 <code>string</code> 类型的键映射到 <code>boolean</code> 值的类型。
如果我们给它赋予 <code>boolean</code> 类型以外的值会报错。</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">BooleanDictionary</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">let</span> myDict<span class="token operator">:</span> BooleanDictionary<span class="token punctuation">;</span>

<span class="token comment">// 允许赋予 boolean 类型的值</span>
myDict<span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
myDict<span class="token punctuation">[</span><span class="token string">'bar'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token comment">// 错误</span>
myDict<span class="token punctuation">[</span><span class="token string">'baz'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'oops'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>虽说在这里 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank" rel="noopener noreferrer"><code>Map</code> 可能是更适合的数据结构<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（具体的说是 <code>Map&lt;string, boolean&gt;</code>），但 JavaScript 对象通常更方便或者正是我们要操作的目标。</p> <p>相似地，<code>Array&lt;T&gt;</code> 已经定义了 <code>number</code> 索引签名，我们可以插入和获取 <code>T</code> 类型的值。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// 这是 TypeScript 内置的部分 Array 类型</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>index<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 没问题</span>
arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'hello!'</span><span class="token punctuation">;</span>

<span class="token comment">// 错误，期待一个 'string' 值</span>
arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>索引签名是一种非常有用的表达方式。
然而，直到现在它们只能使用 <code>string</code> 和 <code>number</code> 类型的键（<code>string</code> 索引签名存在一个有意为之的怪异行为，它们可以接受 <code>number</code> 类型的键，因为 <code>number</code> 会被转换为字符串）。
这意味着 TypeScript 不允许使用 <code>symbol</code> 类型的键来索引对象。
TypeScript 也无法表示由一部分 <code>string</code> 类型的键组成的索引签名 - 例如，对象属性名是以 <code>data-</code> 字符串开头的索引签名。</p> <p>TypeScript 4.4 解决了这个问题，允许 <code>symbol</code> 索引签名以及模版字符串。</p> <p>例如，TypeScript 允许声明一个接受任意 <code>symbol</code> 值作为键的对象类型。</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Colors</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>sym<span class="token operator">:</span> <span class="token builtin">symbol</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> red <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> green <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> blue <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'blue'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> colors<span class="token operator">:</span> Colors <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 没问题</span>
colors<span class="token punctuation">[</span>red<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> redVal <span class="token operator">=</span> colors<span class="token punctuation">[</span>red<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//  ^ number</span>

colors<span class="token punctuation">[</span>blue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'da ba dee'</span><span class="token punctuation">;</span>
<span class="token comment">// 错误：'string' 不能赋值给 'number'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>相似地，可以定义带有模版字符串的索引签名。
一个场景是用来免除对以 <code>data-</code> 开头的属性名执行的 TypeScript 额外属性检查。
当传递一个对象字面量给目标类型时，TypeScript 会检查是否存在相比于目标类型的额外属性。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Options</span> <span class="token punctuation">{</span>
    width<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    height<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> a<span class="token operator">:</span> Options <span class="token operator">=</span> <span class="token punctuation">{</span>
    width<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>

    <span class="token string">'data-blah'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">OptionsWithDataProps</span> <span class="token keyword">extends</span> <span class="token class-name">Options</span> <span class="token punctuation">{</span>
    <span class="token comment">// 允许以 'data-' 开头的属性</span>
    <span class="token punctuation">[</span>optName<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">data-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token builtin">string</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> b<span class="token operator">:</span> OptionsWithDataProps <span class="token operator">=</span> <span class="token punctuation">{</span>
    width<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    <span class="token string">'data-blah'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    <span class="token comment">// 使用未知属性会报错，不包括以 'data-' 开始的属性</span>
    <span class="token string">'unknown-property'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>最后，索引签名现在支持联合类型，只要它们是无限域原始类型的联合 - 尤其是：</p> <ul><li><code>string</code></li> <li><code>number</code></li> <li><code>symbol</code></li> <li>模版字符串（例如 <code>`hello-${string}`</code>）</li></ul> <p>带有以上类型的联合的索引签名会展开为不同的索引签名。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Data</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>optName<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">symbol</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 等同于</span>

<span class="token keyword">interface</span> <span class="token class-name">Data</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>optName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>optName<span class="token operator">:</span> <span class="token builtin">symbol</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/44512" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="defaulting-to-the-unknown-type-in-catch-variables-useunknownincatchvariables"><a href="#defaulting-to-the-unknown-type-in-catch-variables-useunknownincatchvariables" class="header-anchor">#</a> Defaulting to the <code>unknown</code> Type in Catch Variables (<code>--useUnknownInCatchVariables</code>)</h2> <p>In JavaScript, any type of value can be thrown with <code>throw</code> and caught in a <code>catch</code> clause.
Because of this, TypeScript historically typed catch clause variables as <code>any</code>, and would not allow any other type annotation:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// Who knows what this might throw...</span>
    <span class="token function">executeSomeThirdPartyCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// err: any</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Allowed, because 'any'</span>
    err<span class="token punctuation">.</span><span class="token function">thisWillProbablyFail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Allowed, because 'any' :(</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Once TypeScript added the <code>unknown</code> type, it became clear that <code>unknown</code> was a better choice than <code>any</code> in <code>catch</code> clause variables for users who want the highest degree of correctness and type-safety, since it narrows better and forces us to test against arbitrary values.
Eventually TypeScript 4.0 allowed users to specify an explicit type annotation of <code>unknown</code> (or <code>any</code>) on each <code>catch</code> clause variable so that we could opt into stricter types on a case-by-case basis;
however, for some, manually specifying <code>: unknown</code> on every <code>catch</code> clause was a chore.</p> <p>That's why TypeScript 4.4 introduces a new flag called <code>--useUnknownInCatchVariables</code>.
This flag changes the default type of <code>catch</code> clause variables from <code>any</code> to <code>unknown</code>.</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// @errors: 2571</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">executeSomeThirdPartyCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token comment">// ---cut---</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token function">executeSomeThirdPartyCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// err: unknown</span>

    <span class="token comment">// Error! Property 'message' does not exist on type 'unknown'.</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Works! We can narrow 'err' from 'unknown' to 'Error'.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token keyword">instanceof</span> <span class="token class-name">Error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>This flag is enabled under the <code>--strict</code> family of options.
That means that if you check your code using <code>--strict</code>, this option will automatically be turned on.
You may end up with errors in TypeScript 4.4 such as</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Property 'message' does not exist on type 'unknown'.
Property 'name' does not exist on type 'unknown'.
Property 'stack' does not exist on type 'unknown'.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>In cases where we don't want to deal with an <code>unknown</code> variable in a <code>catch</code> clause, we can always add an explicit <code>: any</code> annotation so that we can opt <em>out</em> of stricter types.</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">executeSomeThirdPartyCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token comment">// ---cut---</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token function">executeSomeThirdPartyCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Works again!</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>For more information, take a look at <a href="https://github.com/microsoft/TypeScript/pull/41013" target="_blank" rel="noopener noreferrer">the implementing pull request<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="exact-optional-property-types-exactoptionalpropertytypes"><a href="#exact-optional-property-types-exactoptionalpropertytypes" class="header-anchor">#</a> Exact Optional Property Types (<code>--exactOptionalPropertyTypes</code>)</h2> <p>In JavaScript, reading a <em>missing</em> property on an object produces the value <code>undefined</code>.
It's also possible to <em>have</em> an actual property with the value <code>undefined</code>.
A lot of code in JavaScript tends to treat these situations the same way, and so initially TypeScript just interpreted every optional property as if a user had written <code>undefined</code> in the type.
For example,</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    age<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>was considered equivalent to</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    age<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>What this meant is that a user could explicitly write <code>undefined</code> in place of <code>age</code>.</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> p<span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'Daniel'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token comment">// This is okay by default.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>So by default, TypeScript doesn't distinguish between a present property with the value <code>undefined</code> and a missing property.
While this works most of the time, not all code in JavaScript makes the same assumptions.
Functions and operators like <code>Object.assign</code>, <code>Object.keys</code>, object spread (<code>{ ...obj }</code>), and <code>for</code>-<code>in</code> loops behave differently depending on whether or not a property actually exists on an object.
In the case of our <code>Person</code> example, this could potentially lead to runtime errors if the <code>age</code> property was observed in a context where its presence was important.</p> <p>In TypeScript 4.4, the new flag <code>--exactOptionalPropertyTypes</code> specifies that optional property types should be interpreted exactly as written, meaning that <code>| undefined</code> is not added to the type:</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// @exactOptionalPropertyTypes</span>
<span class="token comment">// @errors: 2322</span>
<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    age<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ---cut---</span>
<span class="token comment">// With 'exactOptionalPropertyTypes' on:</span>
<span class="token keyword">const</span> p<span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'Daniel'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token comment">// Error! undefined isn't a number</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>This flag is <strong>not</strong> part of the <code>--strict</code> family and needs to be turned on explicitly if you'd like this behavior.
It also requires <code>--strictNullChecks</code> to be enabled as well.
We've been making updates to DefinitelyTyped and other definitions to try to make the transition as straightforward as possible, but you may encounter some friction with this depending on how your code is structured.</p> <p>For more information, you can <a href="https://github.com/microsoft/TypeScript/pull/43947" target="_blank" rel="noopener noreferrer">take a look at the implementing pull request here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="static-blocks-in-classes"><a href="#static-blocks-in-classes" class="header-anchor">#</a> <code>static</code> Blocks in Classes</h2> <p>TypeScript 4.4 brings support for <a href="https://github.com/tc39/proposal-class-static-block#ecmascript-class-static-initialization-blocks" target="_blank" rel="noopener noreferrer"><code>static</code> blocks in classes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, an upcoming ECMAScript feature that can help you write more-complex initialization code for static members.</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">someCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token comment">// ---cut---</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// This is a static block:</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">someCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Foo<span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>These static blocks allow you to write a sequence of statements with their own scope that can access private fields within the containing class.
That means that we can write initialization code with all the capabilities of writing statements, no leakage of variables, and full access to our class's internals.</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">loadLastInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment">// ---cut---</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> #count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">get</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Foo<span class="token punctuation">.</span>#count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> lastInstances <span class="token operator">=</span> <span class="token function">loadLastInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Foo<span class="token punctuation">.</span>#count <span class="token operator">+=</span> lastInstances<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>Without <code>static</code> blocks, writing the code above was possible, but often involved several different types of hacks that had to compromise in some way.</p> <p>Note that a class can have multiple <code>static</code> blocks, and they're run in the same order in which they're written.</p> <div class="language-ts twoslash line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// Prints:</span>
<span class="token comment">//    1</span>
<span class="token comment">//    2</span>
<span class="token comment">//    3</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> prop <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Foo<span class="token punctuation">.</span>prop<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Foo<span class="token punctuation">.</span>prop<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Foo<span class="token punctuation">.</span>prop<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>We'd like to extend our thanks to <a href="https://github.com/Kingwl" target="_blank" rel="noopener noreferrer">Wenlu Wang<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for TypeScript's implementation of this feature.
For more details, you can <a href="https://github.com/microsoft/TypeScript/pull/43370" target="_blank" rel="noopener noreferrer">see that pull request here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="tsc-help-updates-and-improvements"><a href="#tsc-help-updates-and-improvements" class="header-anchor">#</a> <code>tsc --help</code> Updates and Improvements</h2> <p>TypeScript's <code>--help</code> option has gotten a refresh!
Thanks to work in part by <a href="https://github.com/ShuiRuTian" target="_blank" rel="noopener noreferrer">Song Gao<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, we've brought in changes to <a href="https://github.com/microsoft/TypeScript/pull/44409" target="_blank" rel="noopener noreferrer">update the descriptions of our compiler options<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://github.com/microsoft/TypeScript/pull/44157" target="_blank" rel="noopener noreferrer">restyle the <code>--help</code> menu<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> with colors and other visual separation.</p> <p><img src="https://devblogs.microsoft.com/typescript/wp-content/uploads/sites/11/2021/08/tsc-help-ps-wt-4-4.png" alt="The new TypeScript  menu where the output is bucketed into several different areas"></p> <p>You can read more on <a href="https://github.com/microsoft/TypeScript/issues/44074" target="_blank" rel="noopener noreferrer">the original proposal thread<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="performance-improvements"><a href="#performance-improvements" class="header-anchor">#</a> Performance Improvements</h2> <h3 id="faster-declaration-emit"><a href="#faster-declaration-emit" class="header-anchor">#</a> Faster Declaration Emit</h3> <p>TypeScript now caches whether internal symbols are accessible in different contexts, along with how specific types should be printed.
These changes can improve TypeScript's general performance in code with fairly complex types, and is especially observed when emitting <code>.d.ts</code> files under the <code>--declaration</code> flag.</p> <p><a href="https://github.com/microsoft/TypeScript/pull/43973" target="_blank" rel="noopener noreferrer">See more details here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="faster-path-normalization"><a href="#faster-path-normalization" class="header-anchor">#</a> Faster Path Normalization</h3> <p>TypeScript often has to do several types of &quot;normalization&quot; on file paths to get them into a consistent format that the compiler can use everywhere.
This involves things like replacing backslashes with slashes, or removing intermediate <code>/./</code> and <code>/../</code> segments of paths.
When TypeScript has to operates over millions of these paths, these operations end up being a bit slow.
In TypeScript 4.4, paths first undergo quick checks to see whether they need any normalization in the first place.
These improvements together reduce project load time by 5-10% on bigger projects, and significantly more in massive projects that we've tested internally.</p> <p>For more details, you can <a href="https://github.com/microsoft/TypeScript/pull/44173" target="_blank" rel="noopener noreferrer">view the PR for path segment normalization<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> along with <a href="https://github.com/microsoft/TypeScript/pull/44100" target="_blank" rel="noopener noreferrer">the PR for slash normalization<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="faster-path-mapping"><a href="#faster-path-mapping" class="header-anchor">#</a> Faster Path Mapping</h3> <p>TypeScript now caches the way it constructs path-mappings (using the <code>paths</code> option in <code>tsconfig.json</code>).
For projects with several hundred mappings, the reduction is significant.
You can see more <a href="https://github.com/microsoft/TypeScript/pull/44078" target="_blank" rel="noopener noreferrer">on the change itself<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="faster-incremental-builds-with-strict"><a href="#faster-incremental-builds-with-strict" class="header-anchor">#</a> Faster Incremental Builds with <code>--strict</code></h3> <p>In what was effectively a bug, TypeScript would end up redoing type-checking work under <code>--incremental</code> compilations if <code>--strict</code> was on.
This led to many builds being just as slow as if <code>--incremental</code> was turned off.
TypeScript 4.4 fixes this, though the change has also been back-ported to TypeScript 4.3.</p> <p>See more <a href="https://github.com/microsoft/TypeScript/pull/44394" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="faster-source-map-generation-for-big-outputs"><a href="#faster-source-map-generation-for-big-outputs" class="header-anchor">#</a> Faster Source Map Generation for Big Outputs</h3> <p>TypeScript 4.4 adds an optimization for source map generation on extremely large output files.
When building an older version of the TypeScript compiler, this results in around an 8% reduction in emit time.</p> <p>We'd like to extend our thanks to <a href="https://github.com/dmichon-msft" target="_blank" rel="noopener noreferrer">David Michon<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> who provided a <a href="https://github.com/microsoft/TypeScript/pull/44031" target="_blank" rel="noopener noreferrer">simple and clean change<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to enable this performance win.</p> <h3 id="faster-force-builds"><a href="#faster-force-builds" class="header-anchor">#</a> Faster <code>--force</code> Builds</h3> <p>When using <code>--build</code> mode on project references, TypeScript has to perform up-to-date checks to determine which files need to be rebuilt.
When performing a <code>--force</code> build, however, that information is irrelevant since every project dependency will be rebuilt from scratch.
In TypeScript 4.4, <code>--force</code> builds avoid those unnecessary steps and start a full build.
See more about the change <a href="https://github.com/microsoft/TypeScript/pull/43666" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="spelling-suggestions-for-javascript"><a href="#spelling-suggestions-for-javascript" class="header-anchor">#</a> Spelling Suggestions for JavaScript</h2> <p>TypeScript powers the JavaScript editing experience in editors like Visual Studio and Visual Studio Code.
Most of the time, TypeScript tries to stay out of the way in JavaScript files;
however, TypeScript often has a lot of information to make confident suggestions, and ways of surfacing suggestions that aren't <em>too</em> invasive.</p> <p>That's why TypeScript now issues spelling suggestions in plain JavaScript files - ones without <code>// @ts-check</code> or in a project with <code>checkJs</code> turned off.
These are the same <em>&quot;Did you mean...?&quot;</em> suggestions that TypeScript files already have, and now they're available in <em>all</em> JavaScript files in some form.</p> <p>These spelling suggestions can provide a subtle clue that your code is wrong.
We managed to find a few bugs in existing code while testing this feature!</p> <p>For more details on this new feature, <a href="https://github.com/microsoft/TypeScript/pull/44271" target="_blank" rel="noopener noreferrer">take a look at the pull request<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>!</p> <h2 id="inlay-hints"><a href="#inlay-hints" class="header-anchor">#</a> Inlay Hints</h2> <p>TypeScript 4.4 provides support for <em>inlay hints</em> which can help display useful information like parameter names and return types in your code.
You can think of it as a sort of friendly &quot;ghost text&quot;.</p> <p><img src="https://devblogs.microsoft.com/typescript/wp-content/uploads/sites/11/2021/08/inlayHints-4.4-rc-ghd.png" alt="A preview of inlay hints in Visual Studio Code"></p> <p>This feature was built by <a href="https://github.com/Kingwl" target="_blank" rel="noopener noreferrer">Wenlu Wang<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> whose <a href="https://github.com/microsoft/TypeScript/pull/42089" target="_blank" rel="noopener noreferrer">pull request<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> has more details.</p> <p>Wenlu also contributed <a href="https://github.com/microsoft/vscode/pull/113412" target="_blank" rel="noopener noreferrer">the integration for inlay hints in Visual Studio Code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> which has shipped as <a href="https://code.visualstudio.com/updates/v1_59#_typescript-44" target="_blank" rel="noopener noreferrer">part of the July 2021 (1.59) release<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
If you'd like to try inlay hints out, make sure you're using a recent <a href="https://code.visualstudio.com/updates/v1_59" target="_blank" rel="noopener noreferrer">stable<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://code.visualstudio.com/insiders/" target="_blank" rel="noopener noreferrer">insiders<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> version of the editor.
You can also modify when and where inlay hints get displayed in Visual Studio Code's settings.</p> <h2 id="auto-imports-show-true-paths-in-completion-lists"><a href="#auto-imports-show-true-paths-in-completion-lists" class="header-anchor">#</a> Auto-Imports Show True Paths in Completion Lists</h2> <p>When editors like Visual Studio Code show a completion list, completions which include auto-imports are displayed with a path to the given module;
however, this path usually isn't what TypeScript ends up placing in a module specifier.
The path is usually something relative to the <em>workspace</em>, meaning that if you're importing from a package like <code>moment</code>, you'll often see a path like <code>node_modules/moment</code>.</p> <p><img src="https://devblogs.microsoft.com/typescript/wp-content/uploads/sites/11/2021/08/completion-import-labels-pre-4-4.png" alt="A completion list containing unwieldy paths containing 'node_modules'. For example, the label for 'calendarFormat' is 'node_modules/moment/moment' instead of 'moment'."></p> <p>These paths end up being unwieldy and often misleading, especially given that the path that actually gets inserted into your file needs to consider Node's <code>node_modules</code> resolution, path mappings, symlinks, and re-exports.</p> <p>That's why with TypeScript 4.4, the completion item label now shows the <em>actual</em> module path that will be used for the import!</p> <p><img src="https://devblogs.microsoft.com/typescript/wp-content/uploads/sites/11/2021/08/completion-import-labels-4-4.png" alt="A completion list containing clean paths with no intermediate 'node_modules'. For example, the label for 'calendarFormat' is 'moment' instead of 'node_modules/moment/moment'."></p> <p>Since this calculation can be expensive, completion lists containing many auto-imports may fill in the final module specifiers in batches as you type more characters. It's possible that you'll still sometimes see the old workspace-relative path labels; however, as your editing experience &quot;warms up&quot;, they should get replaced with the actual path after another keystroke or two.</p> <h2 id="breaking-changes"><a href="#breaking-changes" class="header-anchor">#</a> Breaking Changes</h2> <h3 id="lib-d-ts-changes-for-typescript-4-4"><a href="#lib-d-ts-changes-for-typescript-4-4" class="header-anchor">#</a> <code>lib.d.ts</code> Changes for TypeScript 4.4</h3> <p>As with every TypeScript version, declarations for <code>lib.d.ts</code> (especially the declarations generated for web contexts), have changed.
You can consult <a href="https://github.com/microsoft/TypeScript-DOM-lib-generator/issues/1029#issuecomment-869224737" target="_blank" rel="noopener noreferrer">our list of known <code>lib.dom.d.ts</code> changes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to understand what is impacted.</p> <h3 id="more-compliant-indirect-calls-for-imported-functions"><a href="#more-compliant-indirect-calls-for-imported-functions" class="header-anchor">#</a> More-Compliant Indirect Calls for Imported Functions</h3> <p>In earlier versions of TypeScript, calling an import from CommonJS, AMD, and other non-ES module systems would set the <code>this</code> value of the called function.
Specifically, in the following example, when calling <code>fooModule.foo()</code>, the <code>foo()</code> method will have <code>fooModule</code> set as the value of <code>this</code>.</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// Imagine this is our imported module, and it has an export named 'foo'.</span>
<span class="token keyword">let</span> fooModule <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

fooModule<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>This is not the way exported functions in ECMAScript are supposed to work when we call them.
That's why TypeScript 4.4 intentionally discards the <code>this</code> value when calling imported functions, by using the following emit.</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// Imagine this is our imported module, and it has an export named 'foo'.</span>
<span class="token keyword">let</span> fooModule <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Notice we're actually calling '(0, fooModule.foo)' now, which is subtly different.</span>
<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> fooModule<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>You can <a href="https://github.com/microsoft/TypeScript/pull/44624" target="_blank" rel="noopener noreferrer">read up more about the changes here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="using-unknown-in-catch-variables"><a href="#using-unknown-in-catch-variables" class="header-anchor">#</a> Using <code>unknown</code> in Catch Variables</h3> <p>Users running with the <code>--strict</code> flag may see new errors around <code>catch</code> variables being <code>unknown</code>, especially if the existing code assumes only <code>Error</code> values have been caught.
This often results in error messages such as:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Property 'message' does not exist on type 'unknown'.
Property 'name' does not exist on type 'unknown'.
Property 'stack' does not exist on type 'unknown'.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>To get around this, you can specifically add runtime checks to ensure that the thrown type matches your expected type.
Otherwise, you can just use a type assertion, add an explicit <code>: any</code> to your catch variable, or turn off <code>--useUnknownInCatchVariables</code>.</p> <h3 id="broader-always-truthy-promise-checks"><a href="#broader-always-truthy-promise-checks" class="header-anchor">#</a> Broader Always-Truthy Promise Checks</h3> <p>In prior versions, TypeScript introduced &quot;Always Truthy Promise checks&quot; to catch code where an <code>await</code> may have been forgotten;
however, the checks only applied to named declarations.
That meant that while this code would correctly receive an error...</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fooResult <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fooResult<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// &lt;- error! :D</span>
        <span class="token keyword">return</span> <span class="token string">'true'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">'false'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>...the following code would not.</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// &lt;- no error :(</span>
        <span class="token keyword">return</span> <span class="token string">'true'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">'false'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>TypeScript 4.4 now flags both.
For more information, <a href="https://github.com/microsoft/TypeScript/pull/44491" target="_blank" rel="noopener noreferrer">read up on the original change<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="abstract-properties-do-not-allow-initializers"><a href="#abstract-properties-do-not-allow-initializers" class="header-anchor">#</a> Abstract Properties Do Not Allow Initializers</h3> <p>The following code is now an error because abstract properties may not have initializers:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">abstract</span> prop <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">//       ~~~~</span>
    <span class="token comment">// Property 'prop' cannot have an initializer because it is marked abstract.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Instead, you may only specify a type for the property:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">abstract</span> prop<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/xu-ux/x-blog/edit/master/docs/blogs/Typescript/release-notes/typescript-4.4.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">9/7/2021, 14:33:12</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/x-blog/blogs/Typescript/release-notes/typescript-4.3.html" class="prev">
        拆分属性的写入类型
      </a></span> <!----></p></div>  <div class="footer">
    Copyright © 2021-2021
    <span>Xu-ux | <a href="https://github.com/xu-ux" target="_blank">GitHub</a></span> <div>世间最美好的事情莫过于睡觉</div></div></main></div><div class="global-ui"><!----></div></div>
    <script src="/x-blog/assets/js/app.ce19e263.js" defer></script><script src="/x-blog/assets/js/19.c6894ce7.js" defer></script><script src="/x-blog/assets/js/1.b6d07039.js" defer></script><script src="/x-blog/assets/js/2.9af08480.js" defer></script><script src="/x-blog/assets/js/132.52e9668e.js" defer></script>
  </body>
</html>
